 "Build Engine & Tools" Copyright (c) 1993-1997 Ken Silverman Ken Silverman's official web site: "http://www.advsys.net/ken" See the included license file "BUILDLIC.TXT" for license info. This file has been modified from Ken Silverman's original releaseCOM & NET variablesCOM ONLY variablesNET ONLY variablesUninstall before timerSpecial stuff for WATCOM CClosesocketOpensocketGetinternetworkaddressNetlistenReceivepacketcomvect = 0xb+(comnum&1); Baud-Setting,?,?,Parity O/E,Parity Off/On, Stop-1/2,Bits-5/6/7/8 0x0b is odd parity,1 stop bit, 8 bitsenable latch registers# = 115200 / bps0x03 = n,8,1check for a 16550   0=1,64=4,128=8,192=14Clear any junk already in FIFOsetup for interrupts (modem control)com interrupt disableUnmask vectorcom interrupt enableClosesocketMask vectorSendpacketcomtemp = (rand()&255);if (comtemp == 17)   inbuf[*inbufend] = 17;elseif (comtemp != 11) *inbufend = (((*inbufend)+1)&(COMBUFSIZ-1));if (comtemp == 24){   inbuf[*inbufend] = 17;}comtemp = 4;Check to see if connection number already initializedFind blank place to put new connection numberOut of space! (more than 16 players)Insert connection number on connection number listGetinternetworkaddressSort connection numbersRebuild linked list, MAKING SURE that the linked list goes through   the players in the same order on all computers!Allow initial incnt/outcnt syncingNot rawWait for last packet to be sentAllow initial incnt/outcnt syncingCopy new packet into omess fifoPut last 4 packets into 1 big packetk = omess indexSEND!!!Increment outcnt and omessnum countersPacketcnt errorPrevent 2 Masters!messleng errorCRC errorDon't send reset again if outbufplc is not before incnt!200-255 are messages for engine's use onlyNumber of sub-packets per packet (>= 200) && ( <= 254) Submessleng not necessaryIncrement inbufplc only if first sub-message is read200-255 are messages for engine's use onlyGot good packetDON'T WANT TO GET HERE!!!Increment inbufplc to make it not continuously screw up!Calculate CRC table0x1021 = genpoly[253] (login, if myconnectnum's lowest, then respond with packet type 254)While this doesn't have to be a broadcast, sendingthis info again makes good error correction[254][connectnum][connectnum]...(Packet type 253 response)ClosesocketClosesocketOpensocket "Build Engine & Tools" Copyright (c) 1993-1997 Ken Silverman Ken Silverman's official web site: "http://www.advsys.net/ken" See the included license file "BUILDLIC.TXT" for license info. This file has been modified from Ken Silverman's original releaseCOM & NET variablesCOM ONLY variablesNET ONLY variablesUninstall before timerSpecial stuff for WATCOM CClosesocketOpensocketGetinternetworkaddressNetlistenReceivepacketcomvect = 0xb+(comnum&1); Baud-Setting,?,?,Parity O/E,Parity Off/On, Stop-1/2,Bits-5/6/7/8 0x0b is odd parity,1 stop bit, 8 bitsenable latch registers# = 115200 / bps0x03 = n,8,1check for a 16550   0=1,64=4,128=8,192=14Clear any junk already in FIFOsetup for interrupts (modem control)com interrupt disableUnmask vectorcom interrupt enableClosesocketMask vectorSendpacketcomtemp = (rand()&255);if (comtemp == 17)   inbuf[*inbufend] = 17;elseif (comtemp != 11) *inbufend = (((*inbufend)+1)&(COMBUFSIZ-1));if (comtemp == 24){   inbuf[*inbufend] = 17;}comtemp = 4;Check to see if connection number already initializedFind blank place to put new connection numberOut of space! (more than 16 players)Insert connection number on connection number listGetinternetworkaddressSort connection numbersRebuild linked list, MAKING SURE that the linked list goes through   the players in the same order on all computers!Allow initial incnt/outcnt syncingNot rawWait for last packet to be sentAllow initial incnt/outcnt syncingCopy new packet into omess fifoPut last 4 packets into 1 big packetk = omess indexSEND!!!Increment outcnt and omessnum countersPacketcnt errorPrevent 2 Masters!messleng errorCRC errorDon't send reset again if outbufplc is not before incnt!200-255 are messages for engine's use onlyNumber of sub-packets per packet (>= 200) && ( <= 254) Submessleng not necessaryIncrement inbufplc only if first sub-message is read200-255 are messages for engine's use onlyGot good packetDON'T WANT TO GET HERE!!!Increment inbufplc to make it not continuously screw up!Calculate CRC table0x1021 = genpoly[253] (login, if myconnectnum's lowest, then respond with packet type 254)While this doesn't have to be a broadcast, sendingthis info again makes good error correction[254][connectnum][connectnum]...(Packet type 253 response)ClosesocketClosesocketOpensocket "Build Engine & Tools" Copyright (c) 1993-1997 Ken Silverman Ken Silverman's official web site: "http://www.advsys.net/ken" See the included license file "BUILDLIC.TXT" for license info. This file has been modified from Ken Silverman's original releaseCOM & NET variablesCOM ONLY variablesNET ONLY variablesUninstall before timerSpecial stuff for WATCOM CClosesocketOpensocketGetinternetworkaddressNetlistenReceivepacketcomvect = 0xb+(comnum&1); Baud-Setting,?,?,Parity O/E,Parity Off/On, Stop-1/2,Bits-5/6/7/8 0x0b is odd parity,1 stop bit, 8 bitsenable latch registers# = 115200 / bps0x03 = n,8,1check for a 16550   0=1,64=4,128=8,192=14Clear any junk already in FIFOsetup for interrupts (modem control)com interrupt disableUnmask vectorcom interrupt enableClosesocketMask vectorSendpacketcomtemp = (rand()&255);if (comtemp == 17)   inbuf[*inbufend] = 17;elseif (comtemp != 11) *inbufend = (((*inbufend)+1)&(COMBUFSIZ-1));if (comtemp == 24){   inbuf[*inbufend] = 17;}comtemp = 4;Check to see if connection number already initializedFind blank place to put new connection numberOut of space! (more than 16 players)Insert connection number on connection number listGetinternetworkaddressSort connection numbersRebuild linked list, MAKING SURE that the linked list goes through   the players in the same order on all computers!Allow initial incnt/outcnt syncingNot rawWait for last packet to be sentAllow initial incnt/outcnt syncingCopy new packet into omess fifoPut last 4 packets into 1 big packetk = omess indexSEND!!!Increment outcnt and omessnum countersPacketcnt errorPrevent 2 Masters!messleng errorCRC errorDon't send reset again if outbufplc is not before incnt!200-255 are messages for engine's use onlyNumber of sub-packets per packet (>= 200) && ( <= 254) Submessleng not necessaryIncrement inbufplc only if first sub-message is read200-255 are messages for engine's use onlyGot good packetDON'T WANT TO GET HERE!!!Increment inbufplc to make it not continuously screw up!Calculate CRC table0x1021 = genpoly[253] (login, if myconnectnum's lowest, then respond with packet type 254)While this doesn't have to be a broadcast, sendingthis info again makes good error correction[254][connectnum][connectnum]...(Packet type 253 response)ClosesocketClosesocketOpensocket