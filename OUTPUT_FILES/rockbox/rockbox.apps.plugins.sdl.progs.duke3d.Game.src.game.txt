-------------------------------------------------------------------------
  Copyright (C) 1996, 2003 - 3D Realms Entertainment

  This file is part of Duke Nukem 3D version 1.5 - Atomic Edition

  Duke Nukem 3D is free software; you can redistribute it and/or
  modify it under the terms of the GNU General Public License
  as published by the Free Software Foundation; either version 2
  of the License, or (at your option) any later version.

  This program is distributed in the hope that it will be useful,
  but WITHOUT ANY WARRANTY; without even the implied warranty of
  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.

  See the GNU General Public License for more details.

  You should have received a copy of the GNU General Public License
  aint32_t with this program; if not, write to the Free Software
  Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.

  Original Source: 1996 - Todd Replogle
  Prepared for public release: 03/21/2003 - Charlie Wiederhold, 3D Realms
------------------------------------------------------------------------- #define IDFSIZE 9961476 #define IDFSIZE 16384 Game play speed For addfaz's stun server. use /stun to activate tilesizx[ac]+1; tilesizx[ac]+1; uint8_t  * ltoa(int32_t l, uint8_t  * buffer, int radix); is NON-STANDARD and equivalent to STANDARD (void) sprintf(buffer, "%ld", l);ltoa(n,b,10); uint8_t  typebuflen,typebuf[41]; unknown versionThis is a function from the Engine module, used in getpackets. not a net gameprintf("getpackets() numplayers < 2"); This should have already been handled by mmulti.cpp so ignore it[0] (receive master sync buffer)[1] (receive slave sync buffer) message talk T get names limit size of name we allow the old rancidmeat 19.1 to connect, using the old grpVersion system w/ BYTEVERSION Old rancid was using either BYTEVERSION_27 or BYTEVERSION_117 xDuke Rev ID get map CRC of opponents (to debug out of synch) client refused to disable the autoaim by host Get GRP CRC32 + Con size + exeCRC + conCRCFrom player.cCheck if we should quit the game.Has it been 120ticks ? Returns here when playing a demo.YES : Add 120tickCheck network stuff. x yclearbufbyte(&inputfifo[movefifoend[i]&(MOVEFIFOSIZ-1)][i],sizeof(input),0L);Fix timers and buffer/jitter valueSlaveFix timers and buffer/jitter valueThis allows allow packet-resendsMasterMASTER -> SLAVE packetFix timers and buffer/jitter value FIX_00024: A key can be assigned to the new SHOW_INFO function. Display map CRC when             in deathmatch. Usefull to identify who loaded a wrong map in multiplayer. black translucent background underneath lists FIX_00009: Show map CRC and GRP file version of each player in case of Out Of Synch Disp name Disp MAP CRC FIX_00090: Removed info key. FPS were shown after CRC msg. CRC not always removed. (Turrican)printext256(4L,160L,31,0,"Missed Network packet!",0);printext256(4L,138L,31,0,"RUN DN3DHELP.EXE for information.",0);    uint8_t  fp;    fp = sector[ps[screenpeek].cursectnum].floorpal;REPLACE FULLY uint8_t  * ltoa(int32_t l, uint8_t  * buffer, int radix); is NON-STANDARD and equivalent to STANDARD (void) sprintf(buffer, "%ld", l);ltoa(n,b,10);

  void scratchmarks(int32_t x,int32_t y,int32_t n,uint8_t  s,uint8_t  p)
  {
  int32_t i, ni;

  ni = n/5;
  for(i=ni;i >= 0;i--)
  {
  overwritesprite(x-2,y,SCRATCH+4,s,0,0);
  x += tilesizx[SCRATCH+4]-1;
  }

  ni = n%5;
  if(ni) overwritesprite(x,y,SCRATCH+ni-1,s,p,0);
  }
 FIX_00025: Can toggle FPS and map name during a game (use dnrate OR toggle            from menu when in deathmatch). Display boardfilename and FPS We display the weapons here instead of changing the function displayweapon() because the display will be much faster FIX_00026: Weapon can now be hidden (on your screen only).add fragbars Draw the multi player frag status barDRAW MINI STATUS BAR: FIX_00027: Added an extra small statusbar (HUD)minitext: 2 red light, 23 yellowminitext: 2 red light, 23 yellowDRAW/UPDATE FULL STATUS BAR:0 - update health1 - update armor2 - update PISTOL_WEAPON ammo3 - update SHOTGUN_WEAPON ammo4 - update CHAINGUN_WEAPON ammo5 - update RPG_WEAPON ammo6 - update HANDBOMB_WEAPON ammo7 - update SHRINKER_WEAPON ammo8 - update DEVISTATOR_WEAPON ammo9 - update TRIPBOMB_WEAPON ammo10 - update ammo display11 - update inventory icon12 - update inventory on/off13 - update inventory %14 - update keys15 - update kills16 - update FREEZE_WEAPON ammosprintf(tempbuf, "%s", level_names[ud.volume_number*11 + ud.level_number]); refresh screen and update visible FPS. This is to allow a refresh of the screen when the screensize > 4 w/o compromising the FPS. x = 250 is too much on the right and will make the text going out of the screen if screen <= (320x200) This will also *write beyond the video buffer limit* and will crash the game. || q == 26 || q == 115 || q ==116 || q == 117 || q == 122 ) getpackets(); // Net already off. Trying to get packets here makes sporadic crash.. getpackets(); FIX_00089: scoreboard not shown for last player who quits a DM. Only 19.7 affected. (Sarah) CTW - MODIFICATION      setgamemode(); FIX_00028: No need to call the videodriver on gameexit()              setgamemode(ScreenMode,ScreenWidth,ScreenHeight); CTW END - MODIFICATION deinits network transport.  CTW - MODIFICATION  if( *t != 0 && *(t+1) != 'V' && *(t+1) != 'Y' && playonten == 0 )
    showtwoscreens(); FIX_00029: toggle cinematics on / off CTW END - MODIFICATION CTW - MODIFICATION      if(playonten == 0)
        {
        if(*t == ' ' && *(t+1) == 0) *t = 0;
        printf("\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n");
        printf("%s%s","\n",t);
        } CTW END - MODIFICATION asc_BackSpace message command                for(i=0;i<ud.multimode;i++)sprintf(buf,"PRESS 1-%ld FOR INDIVIDUAL PLAYER.",ud.multimode);gametext(320>>1,j,buf,0,2+8+16); j += 8;gametext(320>>1,j,"'A' OR 'ENTER' FOR ALL PLAYERS",0,2+8+16); j += 8;gametext(320>>1,j,"ESC ABORTS",0,2+8+16); j += 8;Addfaz Console Pause Game line addition FIX_00085: Optimized Video driver. FPS increases by +20%.REPLACE FULLY FIX_00081: Screen border in menu ud.recstat == 2 => playing demo Floor Over Floor If standing in sector with SE42 then draw viewing to SE41 and raise all =hi SE43 cielings. If standing in sector with SE43 then draw viewing to SE40 and lower all =hi SE42 floors. If standing in sector with SE44 then draw viewing to SE40. If standing in sector with SE45 then draw viewing to SE41.short tempcursectnum;Effect TILE fofmode=sprite[spnum].lotag-2; sectnum=sprite[j].sectnum; sectnum=cursectnum;  recursive?
    for(j=0;j<MAXSPRITES;j++)
    {
    if(
    sprite[j].sectnum==sectnum &&
    sprite[j].picnum==1 &&
    sprite[j].lotag==110
    ) { DrawFloorOverFloor(j); break;}
    }
 if(ok==0) { Message("no fof",RED); return; } if(ok==1) { Message("no floor1",RED); return; } if(ok==2) { Message("no floor2",RED); return; } raise ceiling or floor restore ceiling or floor end if end for end SE40            case 40:            case 41:                SE40_Draw(i,x,y,a,smoothratio);                break;printf("1: %d %d\n", oyrepeat,yxaspect);printf("2: %d %d\n", oyrepeat,yxaspect);Block off unscreen section of 90ø tilted screenReverse screen x-wise in this function
  if(s->sectnum < 0)
  {
  s->xrepeat = s->yrepeat = 0;
  changespritestat(i,5);
  }
  Init the size Brown Red green                if(sp->picnum == HELECOPT || sp->picnum == DUKECAR) sp->xvel = 1024; -(1<<4);From the playerFine tune  do not try to make it 0 when ud.hideweapon Will make OOS when shooting in water 64 "money" Make it hitable Make it hitableMake it hitable Delay for lightning Transporters!!!! XPTR END PistonsLeave earilyStopping locfind the two most clostest wall x's and y'sfix all the walls;    T3 = sp->hitag;Flashing lightsIf its openFirst, get the ceiling-floor shadeTake Out;Pivitor rotaterEarthquakemakersBoss CreatureSubwayCaboosSubwaytype sliding doorThat rotating blocker reactor thingESCELATORNo rotational subwaysUPBetween drawrooms() and drawmasks()is the perfect time to animate sprites FIX_00093: fixed crashbugs in multiplayer (mine/blimp) This is the mine issue (confusion bug in hittype[i].temp_data[4] usage) close to blimp bug (search for BLIMP) -> t4 aka macro T5 is incremented at DETONATEB: in actor.c for a time counter. Instead we want an address. Issue happens in confessn.map (do a dnclip + dnkroz + dncoords, start with duke3d_w32 /m /q2 -map confessn.map) go through the Guilty logo till x = -2932, y = 42174, z = 18416. blow up the bomb. Wait in the water. Look at the respawn sign at the bottom of the chain. Crashes when it's about to respawn. Lame fix. ok for w32. Doesn't work for other plateform. How to make a differene between a timer and an address??Hack, for actors - (klabs(daz-t->z)>>11); - (klabs(daz-t->z)>>11); 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24    {"ending"}             FTA(46,&ps[myconnectindex]); cornholio kroz set on set off stuff dnscotty### skill# coords view FTA(22,&ps[myconnectindex],1); time FTA(21,&ps[myconnectindex]); unlockUnlock cashman items rate FIX_00056: Refresh issue w/FPS, small Weapon and custom FTA, when screen resized down beta hyper monsters <RESERVED> ?? <RESERVED> todd showmap allen clip weapons inventory keys debug                    FTA(25,&ps[myconnectindex]); FTA(103,&ps[myconnectindex]); done better in takescreenshot() FIX_00027: Added an extra small statusbar (HUD) FIX_00027: Added an extra small statusbar (HUD) FIX_00065: Music cycling with F5 and SHIFT-F5 messed up Then its 1.3d reg assume 1.5 or plutopak FIX_00074: Shift f5 doesn't change hi-res tunes, but only midi tunes.        if(ud.multimode < 2)                setview(0,0,xdim-1,ydim-1);                setview(0,0,xdim-1,ydim-1); FIX_00030: Brightness step was not the same from the keys vs menu Keyboard step must be 8, as the brightness cursor step. skip filename. FIX_00044: Markers are now on by default in netgames (as real DOS duke3d) Get the file name skip over the file name now that we have it. 16 not enough crap! C1 = DM; C2 =COOP 0 = DM   1 = COOP Show help//This plays the explosion from the nuclear sign at the beginning.MIDI start here"REALITY IS OUR GAME" ScreenAnimate screen (Duke picture wiht "DUKE" "NUKEM 3D" coming from far away and hitting the screen" FIX_00064: Cinematics explosions were not right for 1.3/1.3d grp. FIX_00077: Menu goes directly to the "NEW GAME" sub-menu when starting new game (Turrican) FIX_00079: "waiting player" screen not showing up (black screen) FIX_00091: Main theme starting too early (Bryzian/Turrican)
  ===================
  =
  = ShutDown
  =
  ===================

  ===================
  =
  = Startup
  =
  ===================
 Init the Consoleif(VOLUMEONE){   printf("\n*** You have run Duke Nukem 3D %ld times. ***\n",ud.executions);   if(ud.executions >= 50) puts("IT IS NOW TIME TO UPGRADE TO THE COMPLETE VERSION!!!\n");} CTW - MODIFICATION initengine(ScreenMode,ScreenWidth,ScreenHeight); CTW END - MODIFICATION SBF - wasn't sure if swapping them would harm anything.  AutoAim FIX_00031: Names now limited to 10 chars max that is the fragbar field limit. must not be under "if(numplayers > 1)" so it runs in any case always true. Used to check who we validated [0] still containing the original value user doesn't want AA off. request to stop the game. xDuke TAG ID version x version .y reserved reserved... reserved. See below for single player mode.      getpackets(); send weapon order GRP CRC + CON SIZE + conCRC + exeCRC        getpackets();        getpackets();        getpackets(); from command "case 131:" means we validated this guy checking GRP/CON size from "case 134" FIX_00032: Added multi base GRP manager. Use duke3d*.grp to handle multiple grp.printf(       "This is a debug version 19.7.1 only Based on 19.7\n"              "Fully compliant with v19.7. Added the following:\n\n"              "FIX_00086: grp loaded by smaller sucessive chunks to avoid\n"              "           overloading low ram computers (Spanator)\n"              "FIX_00087: intro in 1024x768 mode being slow. Undone FIX_00070\n"              "           and fixed font issue again (Bryzian)\n"              "FIX_00088: crash on maps using a bad palette index like the end\n"              "           of roch3.map (NY00123)\n"              "FIX_00089: scoreboard not shown for last player who quits a DM.\n"              "           Only 19.7 affected. (Sarah)\n"              "FIX_00090: Removed showinfo key. FPS were shown after CRC msg. \n"              "           CRC not always removed. (Turrican)\n"              "FIX_00091: Main theme starting too early (Bryzian/Turrican)\n"              "FIX_00092: corrupted saved files making the following saved\n"              "           files invisible (Bryzian)\n\n"              "This version should not be distributed. It's not secret but it\n"              "would create a bad mess in the duke community if people start\n"              "using it as it may contain new unsuspected bugs. Only a select\n"              "group of known dukers who know what they are doing should be using\n"              "it. Please report new bugs at xd@m-klein.com or on DX forums. Thx!\n\n"); FIX_00033: Fake multi and AI are now fully working xduke: must be done before checkcommandline or that will prevent Fakeplayer and AI FIX_00022: Automatically recognize the shareware grp (v1.3) + full version (1.3d) +            atomic (1.4/1.5 grp) and the con files version (either 1.3 or 1.4) (JonoF's idea) Detecting grp version We keep the old GRP scheme detection for 19.6 compliance. Will be obsolete. not DC pack not Shareware version 1.3 not Atomic Edition 1.4/1.5 not Regular version 1.3d FIX_00062: Better support and identification for GRP and CON files for 1.3/1.3d/1.4/1.5 computing exe crcfilehandle = open(argv[0],O_BINARY|O_RDONLY); if multimode > 1 and numplayer == 1 => fake player mode on crashes rb->sleep(HZ/5);if(ud.multimode > 1){  playerswhenstarted = ud.multimode; AddFaz fix. This would cause monsters not to spawn when loading a usermap
        if(ud.warp_on == 0)
        {
            ud.m_monsters_off = 1;
            ud.m_player_skill = 0;
        }
                }if game is loaded without /V or /L cmd arguments.check if a user map is loaded and in multiplayer. 7 = usermap.set item spawn options, as they would be ifgame was started via main menu.set skillstart game.play logo, (game must be started via menus).if cmd arguments /V and /L are given.if in multiplayer reset everyones weapon status.set item spawn options, as they would be ifgame was started via main menu.set skillwithout this players would spawn with no weapon.start game.The main game loop is here. (" It's stuck here ")printf("ps[myconnectindex].gm&MODE_GAME\n"); 0 = mine FIX_00015: Backward compliance with older demos (down to demos v27, 28, 116, 117 and 118) || (ud.reccnt < 512) ) 1.3/1.3d style || (ud.reccnt < 512) ) FIX_00062: Better support and identification for GRP and CON files for 1.3/1.3d/1.4/1.5 FIX_00034: Demos do not turn your run mode off anymore:ud.auto_run not needed and would affect autorun status in duke3d.cfg when quitting duke from a demo FIX_00080: Out Of Synch in demos. Tries recovering OOS in old demos v27/28/29/116/117/118. New: v30/v119. FIX_00034: Demos do not turn your run mode off anymore: ud.showweapons =  = ud.auto_run  makes no sense to reset those 2 value! Are we loading a TC? Yes No CTW - MODIFICATION  if ((frecfilep = fopen(d,"wb")) == -1) return; CTW END - MODIFICATION FIX_00062: Better support and identification for GRP and CON files for 1.3/1.3d/1.4/1.5 seems wrong; prolly not needed anyway FIX_00080: Out Of Synch in demos. Tries recovering OOS in old demos v27/28/29/116/117/118. New: v30/v119. CTW - MODIFICATION On my XP machine, demo playback causes the game to crash shortly in. Only bug found so far, not sure if it's OS dependent or compiler or what. Seems to happen when player input starts being simulated, but just guessing. This change effectively disables it. The related code is still enabled. (This is working on Linux, so I flipped it back to '1'. --ryan.) CTW END - MODIFICATION extern int32_t syncs[];
        if(numplayers > 1)
                return 1;
        Goin upAZfallingSmooth on the ground ((fz-(i<<8))-myz)>>1; 412;Smooth on the waterp->ang += syncangvel * constantENGINE calculates angvel for you FIX_00058: Save/load game crash in both single and multiplayer            waitforeverybody();ST 13ST 2ST 5 (must be last)ST 9ST 10ST 12ST 4ST 1ST 3ST 6ST 11    short tinc;tinc = 0; boss Breathetinc = 0;tinc = 0;
===================
=
= GetTime
=
===================

===================
=
= CenterCenter
=
===================

===================
=
= UpperLeft
=
===================

===================
=
= LowerRight
=
===================

===================
=
= CenterThrottle
=
===================

===================
=
= CenterRudder
=
===================
 FIX_00006: better naming system for screenshots + message when pic is taken.            Use ./screenshots folder. Screenshot code rerwritten. Faster and            makes smaller files. Doesn't freeze or lag the game anymore. xduke: Build a nice name w/ date and players name if in multi mode. if more than 1 player, we add name. Then add score if DM if DM or DM No spawn. Add Score as well remove last vs If this is a TC save it to the TC's directory otherwise let's save it to the root. Rare Multiplayer, when dead, total screen screwup back again! E3l1 (Coop /w monsters) sprite list corrupt 50% Univbe exit, instead, default to screen buffer. Check all caches bounds and memory usages Fix enlarger weapon selections to perfection Need sounds.c Spawning a couple of sounds at the same time Check Weapon Switching FIRE and FIRE2 Where should I flash the screen white??? Jittery on subs in mp? Check accurate memory amounts! Why squish sound at hit space when dead? Falling Counter Not reset in mp Wierd small freezer Double freeze on player?, still firing Do Mouse Flip option Save mouse aiming Laser bounce off mirrors GEORGE:   Ten in text screen. Alien: Freeze: change Press space holding player Press space tank broke 2d mode fucked in fake mp mode 207 Mail not rolling up on conveyers Fix all alien animations Do episode names in .CONS do syntak check for "{?????" Make commline parms set approiate multiplayer flags Check all breakables to see if they are exploding properly Fix freezing palette on Alien Do a demo make run overnite Fix Super Duck Slime Guies, use quickkick. Make Lasers from trip bombs reflect off mirrors Remember for lockout of sound swears Pass sender in packed, NOT Fatal sync give no message for TEN Hitting TEN BUTTON(OPTION) no TEN SCreen Check multioperateswitches for se 31,32 Fix pal for ceilings (SE#18) case 31: sprites up one high E1l1 No Kill All troops in room, sleep time Fifo for message list Bloodsplat on conveyers Meclanical Increase sound Mouse Delay at death Wierd slowdown Footprints on stuff floating Ken, The inside function is called a lot in -1 sectors No loading Univbe message rewrite Expander must cycle with rest of weapons Duck SHOOT PIPEBOMB, red wall Get commit source from mark
  1. fix pipebomb bug
  2. check george maps
  4. Save/Restore check (MP and SP)
  5. Check TEN
  6. Get Commit fixed
  8. Is mail slow?
  9. Cacheing
  10. Blue out "PLAY ON TEN" in MULTIPLAYER
  11. Eight Player test
  12. Postal.voc not found.
  13. All Monsters explode in arcade,
  check SEENINE STRENGTH,
  Change 28<<8 back to 16<<8 in hitradius
  Compare 1.3d to 1.4
  14. Check sounds/gfx for for parr lock
  15. Player # Loaded a game
  16. Replace Crane code 1.3d to 1.4
  17. Fix Greenslime
  18. Small Freeze sprite,below floor
  19. Vesa message auto abort in mp?
  20. Fucked Palette in my skip ahead in MP
  21. Load in main menu
  22. Rotated frag screen no game screen
  23. Jibs sounds when killed other dukes
  24. Ten code and /f4 mode
  25. Fix All MP Glitches!!
  26. Unrem Menues anim tenbn
  27. buy groc,clothes,scanner
  28. Why Double Defs in global and game, is so at work
  29. Check that all .objs are erased
  30. Check why 1.3ds gotweapon gamedef coop code no workie
  31. Heavy mods to net code
  32. Make sure all commline stuff works,
  33. killed all waitfor???
  34. 90k stack
  35. double door probs
  36: copy protection
  * when you start a game the duke saying that is played when you choose a skill the sound is cut off.
  * NEWBEASTJUMPING is not deleted at premap in multi-play
  if(*c == '4') no work need objs ask ken, commit
  {
  movesperpacket = 4;
  setpackettimeout(0x3fffffff,0x3fffffff);
  }
  remember, netcode load
  Ai Problem in god mode. Checkplayerhurtwall for forcefields bigforce Nuddie, posters. IMF Release commit.c to public? Document Save bug with mp Check moves per packet /f4 waitforeverybody over net? Kill IDF OBJ No shotguns under water @ tanker Unrem copyprotect Look for printf and puts Check con rewrites erase mmulti.c, or get newest objs Why nomonsters screwy in load menu in mp load last > 'y' == NOT Check xptr oos when dead rising to surface.    diaginal warping with shotguns Test white room.  Lasertripbomb arming crash The Bog Run Duke Out of windows Put Version number in con files Test diff. version playing together Reorganize dukecd Put out patch w/ two weeks testing Print draw3d Double Klick
  Duke Nukem V

  Layout:

  Settings:
  Suburbs
  Duke inflitrating neighborhoods inf. by aliens
  Death Valley:
  Sorta like a western.  Bull-skulls half buried in the sand
  Military compound:  Aliens take over nuke-missle silo, duke
  must destroy.
  Abondend Aircraft field
  Vegas:
  Blast anything bright!  Alien lights camoflauged.
  Alien Drug factory. The Blue Liquid
  Mountainal Cave:
  Interior cave battles.
  Jungle:
  Trees, canopee, animals, a mysterious hole in the earth with
  gas seaping thru.
  Penetencury:
  Good use of spotlights:
  Mental ward:
  People whom have claimed to be slowly changing into an
  alien species

  Inventory:
  Wood,
  Metal,
  Torch,
  Rope,
  Plastique,
  Cloth,
  Wiring,
  Glue,
  Cigars,
  Food,
  Duck Tape,
  Nails,
  Piping,
  Petrol,
  Uranium,
  Gold,
  Prism,
  Power Cell,

  Hand spikes (Limited usage, they become dull)
  Oxygent     (Oxygen mixed with stimulant)


  Player Skills:
  R-Left,R-Right,Foward,Back
  Strafe, Jump, Double Flip Jump for distance
  Help, Escape
  Fire/Use
  Use Menu

  After a brief resbit, Duke decides to get back to work.

  Cmdr:   "Duke, we've got a lot of scared people down there.
  Some reports even claim that people are already
  slowly changing into aliens."
  Duke:   "No problem, my speciality is in croud control."
  Cmdr:   "Croud control, my ass!  Remember that incident
  during the war?  You created nuthin' but death and
  destruction."
  Duke:   "Not destruction, justice."
  Cmdr:   "I'll take no responsibility for your actions.  Your on
  your own!  Behave your self, damnit!  You got that,
  soldger?"
  Duke:   "I've always been on my own...   Face it, it's ass kickin' time,
  SIR!"
  Cmdr:   "Get outta here...!"
  (Duke gives the Cmdr a hard stair, then cocks his weapon and
  walks out of the room)
  Cmdr:   In a wisper: "Good luck, my friend."

  (Cut to a scene where aliens are injecting genetic material
  into an unconcious subject)

  Programming:   ( the functions I need )
  Images: Polys
  Actors:
  Multi-Object sections for change (head,arms,legs,torsoe,all change)
  Facial expressions.  Pal lookup per poly?

  struct imagetype
  {
  int *itable; // AngX,AngY,AngZ,Xoff,Yoff,Zoff;
  int *idata;
  struct imagetype *prev, *next;
  }

 Test frag screen name fuckup Test all xptrs Make Jibs stick to ceiling Save Game menu crash Cache len sum err Loading in main (MP), reset totalclock? White Room Sound hitch with repeat bits Rewrite saved menues so no crash Put a getpackets after loadplayer in menus Put "loading..." before waitfor in loadpla No ready2send = 0 for loading Test Joystick Ten Bog Test Blimp respawn move 1 in player???-------------------------------------------------------------------------
  Copyright (C) 1996, 2003 - 3D Realms Entertainment

  This file is part of Duke Nukem 3D version 1.5 - Atomic Edition

  Duke Nukem 3D is free software; you can redistribute it and/or
  modify it under the terms of the GNU General Public License
  as published by the Free Software Foundation; either version 2
  of the License, or (at your option) any later version.

  This program is distributed in the hope that it will be useful,
  but WITHOUT ANY WARRANTY; without even the implied warranty of
  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.

  See the GNU General Public License for more details.

  You should have received a copy of the GNU General Public License
  aint32_t with this program; if not, write to the Free Software
  Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.

  Original Source: 1996 - Todd Replogle
  Prepared for public release: 03/21/2003 - Charlie Wiederhold, 3D Realms
------------------------------------------------------------------------- #define IDFSIZE 9961476 #define IDFSIZE 16384 Game play speed For addfaz's stun server. use /stun to activate tilesizx[ac]+1; tilesizx[ac]+1; uint8_t  * ltoa(int32_t l, uint8_t  * buffer, int radix); is NON-STANDARD and equivalent to STANDARD (void) sprintf(buffer, "%ld", l);ltoa(n,b,10); uint8_t  typebuflen,typebuf[41]; unknown versionThis is a function from the Engine module, used in getpackets. not a net gameprintf("getpackets() numplayers < 2"); This should have already been handled by mmulti.cpp so ignore it[0] (receive master sync buffer)[1] (receive slave sync buffer) message talk T get names limit size of name we allow the old rancidmeat 19.1 to connect, using the old grpVersion system w/ BYTEVERSION Old rancid was using either BYTEVERSION_27 or BYTEVERSION_117 xDuke Rev ID get map CRC of opponents (to debug out of synch) client refused to disable the autoaim by host Get GRP CRC32 + Con size + exeCRC + conCRCFrom player.cCheck if we should quit the game.Has it been 120ticks ? Returns here when playing a demo.YES : Add 120tickCheck network stuff. x yclearbufbyte(&inputfifo[movefifoend[i]&(MOVEFIFOSIZ-1)][i],sizeof(input),0L);Fix timers and buffer/jitter valueSlaveFix timers and buffer/jitter valueThis allows allow packet-resendsMasterMASTER -> SLAVE packetFix timers and buffer/jitter value FIX_00024: A key can be assigned to the new SHOW_INFO function. Display map CRC when             in deathmatch. Usefull to identify who loaded a wrong map in multiplayer. black translucent background underneath lists FIX_00009: Show map CRC and GRP file version of each player in case of Out Of Synch Disp name Disp MAP CRC FIX_00090: Removed info key. FPS were shown after CRC msg. CRC not always removed. (Turrican)printext256(4L,160L,31,0,"Missed Network packet!",0);printext256(4L,138L,31,0,"RUN DN3DHELP.EXE for information.",0);    uint8_t  fp;    fp = sector[ps[screenpeek].cursectnum].floorpal;REPLACE FULLY uint8_t  * ltoa(int32_t l, uint8_t  * buffer, int radix); is NON-STANDARD and equivalent to STANDARD (void) sprintf(buffer, "%ld", l);ltoa(n,b,10);

  void scratchmarks(int32_t x,int32_t y,int32_t n,uint8_t  s,uint8_t  p)
  {
  int32_t i, ni;

  ni = n/5;
  for(i=ni;i >= 0;i--)
  {
  overwritesprite(x-2,y,SCRATCH+4,s,0,0);
  x += tilesizx[SCRATCH+4]-1;
  }

  ni = n%5;
  if(ni) overwritesprite(x,y,SCRATCH+ni-1,s,p,0);
  }
 FIX_00025: Can toggle FPS and map name during a game (use dnrate OR toggle            from menu when in deathmatch). Display boardfilename and FPS We display the weapons here instead of changing the function displayweapon() because the display will be much faster FIX_00026: Weapon can now be hidden (on your screen only).add fragbars Draw the multi player frag status barDRAW MINI STATUS BAR: FIX_00027: Added an extra small statusbar (HUD)minitext: 2 red light, 23 yellowminitext: 2 red light, 23 yellowDRAW/UPDATE FULL STATUS BAR:0 - update health1 - update armor2 - update PISTOL_WEAPON ammo3 - update SHOTGUN_WEAPON ammo4 - update CHAINGUN_WEAPON ammo5 - update RPG_WEAPON ammo6 - update HANDBOMB_WEAPON ammo7 - update SHRINKER_WEAPON ammo8 - update DEVISTATOR_WEAPON ammo9 - update TRIPBOMB_WEAPON ammo10 - update ammo display11 - update inventory icon12 - update inventory on/off13 - update inventory %14 - update keys15 - update kills16 - update FREEZE_WEAPON ammosprintf(tempbuf, "%s", level_names[ud.volume_number*11 + ud.level_number]); refresh screen and update visible FPS. This is to allow a refresh of the screen when the screensize > 4 w/o compromising the FPS. x = 250 is too much on the right and will make the text going out of the screen if screen <= (320x200) This will also *write beyond the video buffer limit* and will crash the game. || q == 26 || q == 115 || q ==116 || q == 117 || q == 122 ) getpackets(); // Net already off. Trying to get packets here makes sporadic crash.. getpackets(); FIX_00089: scoreboard not shown for last player who quits a DM. Only 19.7 affected. (Sarah) CTW - MODIFICATION      setgamemode(); FIX_00028: No need to call the videodriver on gameexit()              setgamemode(ScreenMode,ScreenWidth,ScreenHeight); CTW END - MODIFICATION deinits network transport.  CTW - MODIFICATION  if( *t != 0 && *(t+1) != 'V' && *(t+1) != 'Y' && playonten == 0 )
    showtwoscreens(); FIX_00029: toggle cinematics on / off CTW END - MODIFICATION CTW - MODIFICATION      if(playonten == 0)
        {
        if(*t == ' ' && *(t+1) == 0) *t = 0;
        printf("\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n");
        printf("%s%s","\n",t);
        } CTW END - MODIFICATION asc_BackSpace message command                for(i=0;i<ud.multimode;i++)sprintf(buf,"PRESS 1-%ld FOR INDIVIDUAL PLAYER.",ud.multimode);gametext(320>>1,j,buf,0,2+8+16); j += 8;gametext(320>>1,j,"'A' OR 'ENTER' FOR ALL PLAYERS",0,2+8+16); j += 8;gametext(320>>1,j,"ESC ABORTS",0,2+8+16); j += 8;Addfaz Console Pause Game line addition FIX_00085: Optimized Video driver. FPS increases by +20%.REPLACE FULLY FIX_00081: Screen border in menu ud.recstat == 2 => playing demo Floor Over Floor If standing in sector with SE42 then draw viewing to SE41 and raise all =hi SE43 cielings. If standing in sector with SE43 then draw viewing to SE40 and lower all =hi SE42 floors. If standing in sector with SE44 then draw viewing to SE40. If standing in sector with SE45 then draw viewing to SE41.short tempcursectnum;Effect TILE fofmode=sprite[spnum].lotag-2; sectnum=sprite[j].sectnum; sectnum=cursectnum;  recursive?
    for(j=0;j<MAXSPRITES;j++)
    {
    if(
    sprite[j].sectnum==sectnum &&
    sprite[j].picnum==1 &&
    sprite[j].lotag==110
    ) { DrawFloorOverFloor(j); break;}
    }
 if(ok==0) { Message("no fof",RED); return; } if(ok==1) { Message("no floor1",RED); return; } if(ok==2) { Message("no floor2",RED); return; } raise ceiling or floor restore ceiling or floor end if end for end SE40            case 40:            case 41:                SE40_Draw(i,x,y,a,smoothratio);                break;printf("1: %d %d\n", oyrepeat,yxaspect);printf("2: %d %d\n", oyrepeat,yxaspect);Block off unscreen section of 90ø tilted screenReverse screen x-wise in this function
  if(s->sectnum < 0)
  {
  s->xrepeat = s->yrepeat = 0;
  changespritestat(i,5);
  }
  Init the size Brown Red green                if(sp->picnum == HELECOPT || sp->picnum == DUKECAR) sp->xvel = 1024; -(1<<4);From the playerFine tune  do not try to make it 0 when ud.hideweapon Will make OOS when shooting in water 64 "money" Make it hitable Make it hitableMake it hitable Delay for lightning Transporters!!!! XPTR END PistonsLeave earilyStopping locfind the two most clostest wall x's and y'sfix all the walls;    T3 = sp->hitag;Flashing lightsIf its openFirst, get the ceiling-floor shadeTake Out;Pivitor rotaterEarthquakemakersBoss CreatureSubwayCaboosSubwaytype sliding doorThat rotating blocker reactor thingESCELATORNo rotational subwaysUPBetween drawrooms() and drawmasks()is the perfect time to animate sprites FIX_00093: fixed crashbugs in multiplayer (mine/blimp) This is the mine issue (confusion bug in hittype[i].temp_data[4] usage) close to blimp bug (search for BLIMP) -> t4 aka macro T5 is incremented at DETONATEB: in actor.c for a time counter. Instead we want an address. Issue happens in confessn.map (do a dnclip + dnkroz + dncoords, start with duke3d_w32 /m /q2 -map confessn.map) go through the Guilty logo till x = -2932, y = 42174, z = 18416. blow up the bomb. Wait in the water. Look at the respawn sign at the bottom of the chain. Crashes when it's about to respawn. Lame fix. ok for w32. Doesn't work for other plateform. How to make a differene between a timer and an address??Hack, for actors - (klabs(daz-t->z)>>11); - (klabs(daz-t->z)>>11); 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24    {"ending"}             FTA(46,&ps[myconnectindex]); cornholio kroz set on set off stuff dnscotty### skill# coords view FTA(22,&ps[myconnectindex],1); time FTA(21,&ps[myconnectindex]); unlockUnlock cashman items rate FIX_00056: Refresh issue w/FPS, small Weapon and custom FTA, when screen resized down beta hyper monsters <RESERVED> ?? <RESERVED> todd showmap allen clip weapons inventory keys debug                    FTA(25,&ps[myconnectindex]); FTA(103,&ps[myconnectindex]); done better in takescreenshot() FIX_00027: Added an extra small statusbar (HUD) FIX_00027: Added an extra small statusbar (HUD) FIX_00065: Music cycling with F5 and SHIFT-F5 messed up Then its 1.3d reg assume 1.5 or plutopak FIX_00074: Shift f5 doesn't change hi-res tunes, but only midi tunes.        if(ud.multimode < 2)                setview(0,0,xdim-1,ydim-1);                setview(0,0,xdim-1,ydim-1); FIX_00030: Brightness step was not the same from the keys vs menu Keyboard step must be 8, as the brightness cursor step. skip filename. FIX_00044: Markers are now on by default in netgames (as real DOS duke3d) Get the file name skip over the file name now that we have it. 16 not enough crap! C1 = DM; C2 =COOP 0 = DM   1 = COOP Show help//This plays the explosion from the nuclear sign at the beginning.MIDI start here"REALITY IS OUR GAME" ScreenAnimate screen (Duke picture wiht "DUKE" "NUKEM 3D" coming from far away and hitting the screen" FIX_00064: Cinematics explosions were not right for 1.3/1.3d grp. FIX_00077: Menu goes directly to the "NEW GAME" sub-menu when starting new game (Turrican) FIX_00079: "waiting player" screen not showing up (black screen) FIX_00091: Main theme starting too early (Bryzian/Turrican)
  ===================
  =
  = ShutDown
  =
  ===================

  ===================
  =
  = Startup
  =
  ===================
 Init the Consoleif(VOLUMEONE){   printf("\n*** You have run Duke Nukem 3D %ld times. ***\n",ud.executions);   if(ud.executions >= 50) puts("IT IS NOW TIME TO UPGRADE TO THE COMPLETE VERSION!!!\n");} CTW - MODIFICATION initengine(ScreenMode,ScreenWidth,ScreenHeight); CTW END - MODIFICATION SBF - wasn't sure if swapping them would harm anything.  AutoAim FIX_00031: Names now limited to 10 chars max that is the fragbar field limit. must not be under "if(numplayers > 1)" so it runs in any case always true. Used to check who we validated [0] still containing the original value user doesn't want AA off. request to stop the game. xDuke TAG ID version x version .y reserved reserved... reserved. See below for single player mode.      getpackets(); send weapon order GRP CRC + CON SIZE + conCRC + exeCRC        getpackets();        getpackets();        getpackets(); from command "case 131:" means we validated this guy checking GRP/CON size from "case 134" FIX_00032: Added multi base GRP manager. Use duke3d*.grp to handle multiple grp.printf(       "This is a debug version 19.7.1 only Based on 19.7\n"              "Fully compliant with v19.7. Added the following:\n\n"              "FIX_00086: grp loaded by smaller sucessive chunks to avoid\n"              "           overloading low ram computers (Spanator)\n"              "FIX_00087: intro in 1024x768 mode being slow. Undone FIX_00070\n"              "           and fixed font issue again (Bryzian)\n"              "FIX_00088: crash on maps using a bad palette index like the end\n"              "           of roch3.map (NY00123)\n"              "FIX_00089: scoreboard not shown for last player who quits a DM.\n"              "           Only 19.7 affected. (Sarah)\n"              "FIX_00090: Removed showinfo key. FPS were shown after CRC msg. \n"              "           CRC not always removed. (Turrican)\n"              "FIX_00091: Main theme starting too early (Bryzian/Turrican)\n"              "FIX_00092: corrupted saved files making the following saved\n"              "           files invisible (Bryzian)\n\n"              "This version should not be distributed. It's not secret but it\n"              "would create a bad mess in the duke community if people start\n"              "using it as it may contain new unsuspected bugs. Only a select\n"              "group of known dukers who know what they are doing should be using\n"              "it. Please report new bugs at xd@m-klein.com or on DX forums. Thx!\n\n"); FIX_00033: Fake multi and AI are now fully working xduke: must be done before checkcommandline or that will prevent Fakeplayer and AI FIX_00022: Automatically recognize the shareware grp (v1.3) + full version (1.3d) +            atomic (1.4/1.5 grp) and the con files version (either 1.3 or 1.4) (JonoF's idea) Detecting grp version We keep the old GRP scheme detection for 19.6 compliance. Will be obsolete. not DC pack not Shareware version 1.3 not Atomic Edition 1.4/1.5 not Regular version 1.3d FIX_00062: Better support and identification for GRP and CON files for 1.3/1.3d/1.4/1.5 computing exe crcfilehandle = open(argv[0],O_BINARY|O_RDONLY); if multimode > 1 and numplayer == 1 => fake player mode on crashes rb->sleep(HZ/5);if(ud.multimode > 1){  playerswhenstarted = ud.multimode; AddFaz fix. This would cause monsters not to spawn when loading a usermap
        if(ud.warp_on == 0)
        {
            ud.m_monsters_off = 1;
            ud.m_player_skill = 0;
        }
                }if game is loaded without /V or /L cmd arguments.check if a user map is loaded and in multiplayer. 7 = usermap.set item spawn options, as they would be ifgame was started via main menu.set skillstart game.play logo, (game must be started via menus).if cmd arguments /V and /L are given.if in multiplayer reset everyones weapon status.set item spawn options, as they would be ifgame was started via main menu.set skillwithout this players would spawn with no weapon.start game.The main game loop is here. (" It's stuck here ")printf("ps[myconnectindex].gm&MODE_GAME\n"); 0 = mine FIX_00015: Backward compliance with older demos (down to demos v27, 28, 116, 117 and 118) || (ud.reccnt < 512) ) 1.3/1.3d style || (ud.reccnt < 512) ) FIX_00062: Better support and identification for GRP and CON files for 1.3/1.3d/1.4/1.5 FIX_00034: Demos do not turn your run mode off anymore:ud.auto_run not needed and would affect autorun status in duke3d.cfg when quitting duke from a demo FIX_00080: Out Of Synch in demos. Tries recovering OOS in old demos v27/28/29/116/117/118. New: v30/v119. FIX_00034: Demos do not turn your run mode off anymore: ud.showweapons =  = ud.auto_run  makes no sense to reset those 2 value! Are we loading a TC? Yes No CTW - MODIFICATION  if ((frecfilep = fopen(d,"wb")) == -1) return; CTW END - MODIFICATION FIX_00062: Better support and identification for GRP and CON files for 1.3/1.3d/1.4/1.5 seems wrong; prolly not needed anyway FIX_00080: Out Of Synch in demos. Tries recovering OOS in old demos v27/28/29/116/117/118. New: v30/v119. CTW - MODIFICATION On my XP machine, demo playback causes the game to crash shortly in. Only bug found so far, not sure if it's OS dependent or compiler or what. Seems to happen when player input starts being simulated, but just guessing. This change effectively disables it. The related code is still enabled. (This is working on Linux, so I flipped it back to '1'. --ryan.) CTW END - MODIFICATION extern int32_t syncs[];
        if(numplayers > 1)
                return 1;
        Goin upAZfallingSmooth on the ground ((fz-(i<<8))-myz)>>1; 412;Smooth on the waterp->ang += syncangvel * constantENGINE calculates angvel for you FIX_00058: Save/load game crash in both single and multiplayer            waitforeverybody();ST 13ST 2ST 5 (must be last)ST 9ST 10ST 12ST 4ST 1ST 3ST 6ST 11    short tinc;tinc = 0; boss Breathetinc = 0;tinc = 0;
===================
=
= GetTime
=
===================

===================
=
= CenterCenter
=
===================

===================
=
= UpperLeft
=
===================

===================
=
= LowerRight
=
===================

===================
=
= CenterThrottle
=
===================

===================
=
= CenterRudder
=
===================
 FIX_00006: better naming system for screenshots + message when pic is taken.            Use ./screenshots folder. Screenshot code rerwritten. Faster and            makes smaller files. Doesn't freeze or lag the game anymore. xduke: Build a nice name w/ date and players name if in multi mode. if more than 1 player, we add name. Then add score if DM if DM or DM No spawn. Add Score as well remove last vs If this is a TC save it to the TC's directory otherwise let's save it to the root. Rare Multiplayer, when dead, total screen screwup back again! E3l1 (Coop /w monsters) sprite list corrupt 50% Univbe exit, instead, default to screen buffer. Check all caches bounds and memory usages Fix enlarger weapon selections to perfection Need sounds.c Spawning a couple of sounds at the same time Check Weapon Switching FIRE and FIRE2 Where should I flash the screen white??? Jittery on subs in mp? Check accurate memory amounts! Why squish sound at hit space when dead? Falling Counter Not reset in mp Wierd small freezer Double freeze on player?, still firing Do Mouse Flip option Save mouse aiming Laser bounce off mirrors GEORGE:   Ten in text screen. Alien: Freeze: change Press space holding player Press space tank broke 2d mode fucked in fake mp mode 207 Mail not rolling up on conveyers Fix all alien animations Do episode names in .CONS do syntak check for "{?????" Make commline parms set approiate multiplayer flags Check all breakables to see if they are exploding properly Fix freezing palette on Alien Do a demo make run overnite Fix Super Duck Slime Guies, use quickkick. Make Lasers from trip bombs reflect off mirrors Remember for lockout of sound swears Pass sender in packed, NOT Fatal sync give no message for TEN Hitting TEN BUTTON(OPTION) no TEN SCreen Check multioperateswitches for se 31,32 Fix pal for ceilings (SE#18) case 31: sprites up one high E1l1 No Kill All troops in room, sleep time Fifo for message list Bloodsplat on conveyers Meclanical Increase sound Mouse Delay at death Wierd slowdown Footprints on stuff floating Ken, The inside function is called a lot in -1 sectors No loading Univbe message rewrite Expander must cycle with rest of weapons Duck SHOOT PIPEBOMB, red wall Get commit source from mark
  1. fix pipebomb bug
  2. check george maps
  4. Save/Restore check (MP and SP)
  5. Check TEN
  6. Get Commit fixed
  8. Is mail slow?
  9. Cacheing
  10. Blue out "PLAY ON TEN" in MULTIPLAYER
  11. Eight Player test
  12. Postal.voc not found.
  13. All Monsters explode in arcade,
  check SEENINE STRENGTH,
  Change 28<<8 back to 16<<8 in hitradius
  Compare 1.3d to 1.4
  14. Check sounds/gfx for for parr lock
  15. Player # Loaded a game
  16. Replace Crane code 1.3d to 1.4
  17. Fix Greenslime
  18. Small Freeze sprite,below floor
  19. Vesa message auto abort in mp?
  20. Fucked Palette in my skip ahead in MP
  21. Load in main menu
  22. Rotated frag screen no game screen
  23. Jibs sounds when killed other dukes
  24. Ten code and /f4 mode
  25. Fix All MP Glitches!!
  26. Unrem Menues anim tenbn
  27. buy groc,clothes,scanner
  28. Why Double Defs in global and game, is so at work
  29. Check that all .objs are erased
  30. Check why 1.3ds gotweapon gamedef coop code no workie
  31. Heavy mods to net code
  32. Make sure all commline stuff works,
  33. killed all waitfor???
  34. 90k stack
  35. double door probs
  36: copy protection
  * when you start a game the duke saying that is played when you choose a skill the sound is cut off.
  * NEWBEASTJUMPING is not deleted at premap in multi-play
  if(*c == '4') no work need objs ask ken, commit
  {
  movesperpacket = 4;
  setpackettimeout(0x3fffffff,0x3fffffff);
  }
  remember, netcode load
  Ai Problem in god mode. Checkplayerhurtwall for forcefields bigforce Nuddie, posters. IMF Release commit.c to public? Document Save bug with mp Check moves per packet /f4 waitforeverybody over net? Kill IDF OBJ No shotguns under water @ tanker Unrem copyprotect Look for printf and puts Check con rewrites erase mmulti.c, or get newest objs Why nomonsters screwy in load menu in mp load last > 'y' == NOT Check xptr oos when dead rising to surface.    diaginal warping with shotguns Test white room.  Lasertripbomb arming crash The Bog Run Duke Out of windows Put Version number in con files Test diff. version playing together Reorganize dukecd Put out patch w/ two weeks testing Print draw3d Double Klick
  Duke Nukem V

  Layout:

  Settings:
  Suburbs
  Duke inflitrating neighborhoods inf. by aliens
  Death Valley:
  Sorta like a western.  Bull-skulls half buried in the sand
  Military compound:  Aliens take over nuke-missle silo, duke
  must destroy.
  Abondend Aircraft field
  Vegas:
  Blast anything bright!  Alien lights camoflauged.
  Alien Drug factory. The Blue Liquid
  Mountainal Cave:
  Interior cave battles.
  Jungle:
  Trees, canopee, animals, a mysterious hole in the earth with
  gas seaping thru.
  Penetencury:
  Good use of spotlights:
  Mental ward:
  People whom have claimed to be slowly changing into an
  alien species

  Inventory:
  Wood,
  Metal,
  Torch,
  Rope,
  Plastique,
  Cloth,
  Wiring,
  Glue,
  Cigars,
  Food,
  Duck Tape,
  Nails,
  Piping,
  Petrol,
  Uranium,
  Gold,
  Prism,
  Power Cell,

  Hand spikes (Limited usage, they become dull)
  Oxygent     (Oxygen mixed with stimulant)


  Player Skills:
  R-Left,R-Right,Foward,Back
  Strafe, Jump, Double Flip Jump for distance
  Help, Escape
  Fire/Use
  Use Menu

  After a brief resbit, Duke decides to get back to work.

  Cmdr:   "Duke, we've got a lot of scared people down there.
  Some reports even claim that people are already
  slowly changing into aliens."
  Duke:   "No problem, my speciality is in croud control."
  Cmdr:   "Croud control, my ass!  Remember that incident
  during the war?  You created nuthin' but death and
  destruction."
  Duke:   "Not destruction, justice."
  Cmdr:   "I'll take no responsibility for your actions.  Your on
  your own!  Behave your self, damnit!  You got that,
  soldger?"
  Duke:   "I've always been on my own...   Face it, it's ass kickin' time,
  SIR!"
  Cmdr:   "Get outta here...!"
  (Duke gives the Cmdr a hard stair, then cocks his weapon and
  walks out of the room)
  Cmdr:   In a wisper: "Good luck, my friend."

  (Cut to a scene where aliens are injecting genetic material
  into an unconcious subject)

  Programming:   ( the functions I need )
  Images: Polys
  Actors:
  Multi-Object sections for change (head,arms,legs,torsoe,all change)
  Facial expressions.  Pal lookup per poly?

  struct imagetype
  {
  int *itable; // AngX,AngY,AngZ,Xoff,Yoff,Zoff;
  int *idata;
  struct imagetype *prev, *next;
  }

 Test frag screen name fuckup Test all xptrs Make Jibs stick to ceiling Save Game menu crash Cache len sum err Loading in main (MP), reset totalclock? White Room Sound hitch with repeat bits Rewrite saved menues so no crash Put a getpackets after loadplayer in menus Put "loading..." before waitfor in loadpla No ready2send = 0 for loading Test Joystick Ten Bog Test Blimp respawn move 1 in player???-------------------------------------------------------------------------
  Copyright (C) 1996, 2003 - 3D Realms Entertainment

  This file is part of Duke Nukem 3D version 1.5 - Atomic Edition

  Duke Nukem 3D is free software; you can redistribute it and/or
  modify it under the terms of the GNU General Public License
  as published by the Free Software Foundation; either version 2
  of the License, or (at your option) any later version.

  This program is distributed in the hope that it will be useful,
  but WITHOUT ANY WARRANTY; without even the implied warranty of
  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.

  See the GNU General Public License for more details.

  You should have received a copy of the GNU General Public License
  aint32_t with this program; if not, write to the Free Software
  Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.

  Original Source: 1996 - Todd Replogle
  Prepared for public release: 03/21/2003 - Charlie Wiederhold, 3D Realms
------------------------------------------------------------------------- #define IDFSIZE 9961476 #define IDFSIZE 16384 Game play speed For addfaz's stun server. use /stun to activate tilesizx[ac]+1; tilesizx[ac]+1; uint8_t  * ltoa(int32_t l, uint8_t  * buffer, int radix); is NON-STANDARD and equivalent to STANDARD (void) sprintf(buffer, "%ld", l);ltoa(n,b,10); uint8_t  typebuflen,typebuf[41]; unknown versionThis is a function from the Engine module, used in getpackets. not a net gameprintf("getpackets() numplayers < 2"); This should have already been handled by mmulti.cpp so ignore it[0] (receive master sync buffer)[1] (receive slave sync buffer) message talk T get names limit size of name we allow the old rancidmeat 19.1 to connect, using the old grpVersion system w/ BYTEVERSION Old rancid was using either BYTEVERSION_27 or BYTEVERSION_117 xDuke Rev ID get map CRC of opponents (to debug out of synch) client refused to disable the autoaim by host Get GRP CRC32 + Con size + exeCRC + conCRCFrom player.cCheck if we should quit the game.Has it been 120ticks ? Returns here when playing a demo.YES : Add 120tickCheck network stuff. x yclearbufbyte(&inputfifo[movefifoend[i]&(MOVEFIFOSIZ-1)][i],sizeof(input),0L);Fix timers and buffer/jitter valueSlaveFix timers and buffer/jitter valueThis allows allow packet-resendsMasterMASTER -> SLAVE packetFix timers and buffer/jitter value FIX_00024: A key can be assigned to the new SHOW_INFO function. Display map CRC when             in deathmatch. Usefull to identify who loaded a wrong map in multiplayer. black translucent background underneath lists FIX_00009: Show map CRC and GRP file version of each player in case of Out Of Synch Disp name Disp MAP CRC FIX_00090: Removed info key. FPS were shown after CRC msg. CRC not always removed. (Turrican)printext256(4L,160L,31,0,"Missed Network packet!",0);printext256(4L,138L,31,0,"RUN DN3DHELP.EXE for information.",0);    uint8_t  fp;    fp = sector[ps[screenpeek].cursectnum].floorpal;REPLACE FULLY uint8_t  * ltoa(int32_t l, uint8_t  * buffer, int radix); is NON-STANDARD and equivalent to STANDARD (void) sprintf(buffer, "%ld", l);ltoa(n,b,10);

  void scratchmarks(int32_t x,int32_t y,int32_t n,uint8_t  s,uint8_t  p)
  {
  int32_t i, ni;

  ni = n/5;
  for(i=ni;i >= 0;i--)
  {
  overwritesprite(x-2,y,SCRATCH+4,s,0,0);
  x += tilesizx[SCRATCH+4]-1;
  }

  ni = n%5;
  if(ni) overwritesprite(x,y,SCRATCH+ni-1,s,p,0);
  }
 FIX_00025: Can toggle FPS and map name during a game (use dnrate OR toggle            from menu when in deathmatch). Display boardfilename and FPS We display the weapons here instead of changing the function displayweapon() because the display will be much faster FIX_00026: Weapon can now be hidden (on your screen only).add fragbars Draw the multi player frag status barDRAW MINI STATUS BAR: FIX_00027: Added an extra small statusbar (HUD)minitext: 2 red light, 23 yellowminitext: 2 red light, 23 yellowDRAW/UPDATE FULL STATUS BAR:0 - update health1 - update armor2 - update PISTOL_WEAPON ammo3 - update SHOTGUN_WEAPON ammo4 - update CHAINGUN_WEAPON ammo5 - update RPG_WEAPON ammo6 - update HANDBOMB_WEAPON ammo7 - update SHRINKER_WEAPON ammo8 - update DEVISTATOR_WEAPON ammo9 - update TRIPBOMB_WEAPON ammo10 - update ammo display11 - update inventory icon12 - update inventory on/off13 - update inventory %14 - update keys15 - update kills16 - update FREEZE_WEAPON ammosprintf(tempbuf, "%s", level_names[ud.volume_number*11 + ud.level_number]); refresh screen and update visible FPS. This is to allow a refresh of the screen when the screensize > 4 w/o compromising the FPS. x = 250 is too much on the right and will make the text going out of the screen if screen <= (320x200) This will also *write beyond the video buffer limit* and will crash the game. || q == 26 || q == 115 || q ==116 || q == 117 || q == 122 ) getpackets(); // Net already off. Trying to get packets here makes sporadic crash.. getpackets(); FIX_00089: scoreboard not shown for last player who quits a DM. Only 19.7 affected. (Sarah) CTW - MODIFICATION      setgamemode(); FIX_00028: No need to call the videodriver on gameexit()              setgamemode(ScreenMode,ScreenWidth,ScreenHeight); CTW END - MODIFICATION deinits network transport.  CTW - MODIFICATION  if( *t != 0 && *(t+1) != 'V' && *(t+1) != 'Y' && playonten == 0 )
    showtwoscreens(); FIX_00029: toggle cinematics on / off CTW END - MODIFICATION CTW - MODIFICATION      if(playonten == 0)
        {
        if(*t == ' ' && *(t+1) == 0) *t = 0;
        printf("\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n");
        printf("%s%s","\n",t);
        } CTW END - MODIFICATION asc_BackSpace message command                for(i=0;i<ud.multimode;i++)sprintf(buf,"PRESS 1-%ld FOR INDIVIDUAL PLAYER.",ud.multimode);gametext(320>>1,j,buf,0,2+8+16); j += 8;gametext(320>>1,j,"'A' OR 'ENTER' FOR ALL PLAYERS",0,2+8+16); j += 8;gametext(320>>1,j,"ESC ABORTS",0,2+8+16); j += 8;Addfaz Console Pause Game line addition FIX_00085: Optimized Video driver. FPS increases by +20%.REPLACE FULLY FIX_00081: Screen border in menu ud.recstat == 2 => playing demo Floor Over Floor If standing in sector with SE42 then draw viewing to SE41 and raise all =hi SE43 cielings. If standing in sector with SE43 then draw viewing to SE40 and lower all =hi SE42 floors. If standing in sector with SE44 then draw viewing to SE40. If standing in sector with SE45 then draw viewing to SE41.short tempcursectnum;Effect TILE fofmode=sprite[spnum].lotag-2; sectnum=sprite[j].sectnum; sectnum=cursectnum;  recursive?
    for(j=0;j<MAXSPRITES;j++)
    {
    if(
    sprite[j].sectnum==sectnum &&
    sprite[j].picnum==1 &&
    sprite[j].lotag==110
    ) { DrawFloorOverFloor(j); break;}
    }
 if(ok==0) { Message("no fof",RED); return; } if(ok==1) { Message("no floor1",RED); return; } if(ok==2) { Message("no floor2",RED); return; } raise ceiling or floor restore ceiling or floor end if end for end SE40            case 40:            case 41:                SE40_Draw(i,x,y,a,smoothratio);                break;printf("1: %d %d\n", oyrepeat,yxaspect);printf("2: %d %d\n", oyrepeat,yxaspect);Block off unscreen section of 90ø tilted screenReverse screen x-wise in this function
  if(s->sectnum < 0)
  {
  s->xrepeat = s->yrepeat = 0;
  changespritestat(i,5);
  }
  Init the size Brown Red green                if(sp->picnum == HELECOPT || sp->picnum == DUKECAR) sp->xvel = 1024; -(1<<4);From the playerFine tune  do not try to make it 0 when ud.hideweapon Will make OOS when shooting in water 64 "money" Make it hitable Make it hitableMake it hitable Delay for lightning Transporters!!!! XPTR END PistonsLeave earilyStopping locfind the two most clostest wall x's and y'sfix all the walls;    T3 = sp->hitag;Flashing lightsIf its openFirst, get the ceiling-floor shadeTake Out;Pivitor rotaterEarthquakemakersBoss CreatureSubwayCaboosSubwaytype sliding doorThat rotating blocker reactor thingESCELATORNo rotational subwaysUPBetween drawrooms() and drawmasks()is the perfect time to animate sprites FIX_00093: fixed crashbugs in multiplayer (mine/blimp) This is the mine issue (confusion bug in hittype[i].temp_data[4] usage) close to blimp bug (search for BLIMP) -> t4 aka macro T5 is incremented at DETONATEB: in actor.c for a time counter. Instead we want an address. Issue happens in confessn.map (do a dnclip + dnkroz + dncoords, start with duke3d_w32 /m /q2 -map confessn.map) go through the Guilty logo till x = -2932, y = 42174, z = 18416. blow up the bomb. Wait in the water. Look at the respawn sign at the bottom of the chain. Crashes when it's about to respawn. Lame fix. ok for w32. Doesn't work for other plateform. How to make a differene between a timer and an address??Hack, for actors - (klabs(daz-t->z)>>11); - (klabs(daz-t->z)>>11); 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24    {"ending"}             FTA(46,&ps[myconnectindex]); cornholio kroz set on set off stuff dnscotty### skill# coords view FTA(22,&ps[myconnectindex],1); time FTA(21,&ps[myconnectindex]); unlockUnlock cashman items rate FIX_00056: Refresh issue w/FPS, small Weapon and custom FTA, when screen resized down beta hyper monsters <RESERVED> ?? <RESERVED> todd showmap allen clip weapons inventory keys debug                    FTA(25,&ps[myconnectindex]); FTA(103,&ps[myconnectindex]); done better in takescreenshot() FIX_00027: Added an extra small statusbar (HUD) FIX_00027: Added an extra small statusbar (HUD) FIX_00065: Music cycling with F5 and SHIFT-F5 messed up Then its 1.3d reg assume 1.5 or plutopak FIX_00074: Shift f5 doesn't change hi-res tunes, but only midi tunes.        if(ud.multimode < 2)                setview(0,0,xdim-1,ydim-1);                setview(0,0,xdim-1,ydim-1); FIX_00030: Brightness step was not the same from the keys vs menu Keyboard step must be 8, as the brightness cursor step. skip filename. FIX_00044: Markers are now on by default in netgames (as real DOS duke3d) Get the file name skip over the file name now that we have it. 16 not enough crap! C1 = DM; C2 =COOP 0 = DM   1 = COOP Show help//This plays the explosion from the nuclear sign at the beginning.MIDI start here"REALITY IS OUR GAME" ScreenAnimate screen (Duke picture wiht "DUKE" "NUKEM 3D" coming from far away and hitting the screen" FIX_00064: Cinematics explosions were not right for 1.3/1.3d grp. FIX_00077: Menu goes directly to the "NEW GAME" sub-menu when starting new game (Turrican) FIX_00079: "waiting player" screen not showing up (black screen) FIX_00091: Main theme starting too early (Bryzian/Turrican)
  ===================
  =
  = ShutDown
  =
  ===================

  ===================
  =
  = Startup
  =
  ===================
 Init the Consoleif(VOLUMEONE){   printf("\n*** You have run Duke Nukem 3D %ld times. ***\n",ud.executions);   if(ud.executions >= 50) puts("IT IS NOW TIME TO UPGRADE TO THE COMPLETE VERSION!!!\n");} CTW - MODIFICATION initengine(ScreenMode,ScreenWidth,ScreenHeight); CTW END - MODIFICATION SBF - wasn't sure if swapping them would harm anything.  AutoAim FIX_00031: Names now limited to 10 chars max that is the fragbar field limit. must not be under "if(numplayers > 1)" so it runs in any case always true. Used to check who we validated [0] still containing the original value user doesn't want AA off. request to stop the game. xDuke TAG ID version x version .y reserved reserved... reserved. See below for single player mode.      getpackets(); send weapon order GRP CRC + CON SIZE + conCRC + exeCRC        getpackets();        getpackets();        getpackets(); from command "case 131:" means we validated this guy checking GRP/CON size from "case 134" FIX_00032: Added multi base GRP manager. Use duke3d*.grp to handle multiple grp.printf(       "This is a debug version 19.7.1 only Based on 19.7\n"              "Fully compliant with v19.7. Added the following:\n\n"              "FIX_00086: grp loaded by smaller sucessive chunks to avoid\n"              "           overloading low ram computers (Spanator)\n"              "FIX_00087: intro in 1024x768 mode being slow. Undone FIX_00070\n"              "           and fixed font issue again (Bryzian)\n"              "FIX_00088: crash on maps using a bad palette index like the end\n"              "           of roch3.map (NY00123)\n"              "FIX_00089: scoreboard not shown for last player who quits a DM.\n"              "           Only 19.7 affected. (Sarah)\n"              "FIX_00090: Removed showinfo key. FPS were shown after CRC msg. \n"              "           CRC not always removed. (Turrican)\n"              "FIX_00091: Main theme starting too early (Bryzian/Turrican)\n"              "FIX_00092: corrupted saved files making the following saved\n"              "           files invisible (Bryzian)\n\n"              "This version should not be distributed. It's not secret but it\n"              "would create a bad mess in the duke community if people start\n"              "using it as it may contain new unsuspected bugs. Only a select\n"              "group of known dukers who know what they are doing should be using\n"              "it. Please report new bugs at xd@m-klein.com or on DX forums. Thx!\n\n"); FIX_00033: Fake multi and AI are now fully working xduke: must be done before checkcommandline or that will prevent Fakeplayer and AI FIX_00022: Automatically recognize the shareware grp (v1.3) + full version (1.3d) +            atomic (1.4/1.5 grp) and the con files version (either 1.3 or 1.4) (JonoF's idea) Detecting grp version We keep the old GRP scheme detection for 19.6 compliance. Will be obsolete. not DC pack not Shareware version 1.3 not Atomic Edition 1.4/1.5 not Regular version 1.3d FIX_00062: Better support and identification for GRP and CON files for 1.3/1.3d/1.4/1.5 computing exe crcfilehandle = open(argv[0],O_BINARY|O_RDONLY); if multimode > 1 and numplayer == 1 => fake player mode on crashes rb->sleep(HZ/5);if(ud.multimode > 1){  playerswhenstarted = ud.multimode; AddFaz fix. This would cause monsters not to spawn when loading a usermap
        if(ud.warp_on == 0)
        {
            ud.m_monsters_off = 1;
            ud.m_player_skill = 0;
        }
                }if game is loaded without /V or /L cmd arguments.check if a user map is loaded and in multiplayer. 7 = usermap.set item spawn options, as they would be ifgame was started via main menu.set skillstart game.play logo, (game must be started via menus).if cmd arguments /V and /L are given.if in multiplayer reset everyones weapon status.set item spawn options, as they would be ifgame was started via main menu.set skillwithout this players would spawn with no weapon.start game.The main game loop is here. (" It's stuck here ")printf("ps[myconnectindex].gm&MODE_GAME\n"); 0 = mine FIX_00015: Backward compliance with older demos (down to demos v27, 28, 116, 117 and 118) || (ud.reccnt < 512) ) 1.3/1.3d style || (ud.reccnt < 512) ) FIX_00062: Better support and identification for GRP and CON files for 1.3/1.3d/1.4/1.5 FIX_00034: Demos do not turn your run mode off anymore:ud.auto_run not needed and would affect autorun status in duke3d.cfg when quitting duke from a demo FIX_00080: Out Of Synch in demos. Tries recovering OOS in old demos v27/28/29/116/117/118. New: v30/v119. FIX_00034: Demos do not turn your run mode off anymore: ud.showweapons =  = ud.auto_run  makes no sense to reset those 2 value! Are we loading a TC? Yes No CTW - MODIFICATION  if ((frecfilep = fopen(d,"wb")) == -1) return; CTW END - MODIFICATION FIX_00062: Better support and identification for GRP and CON files for 1.3/1.3d/1.4/1.5 seems wrong; prolly not needed anyway FIX_00080: Out Of Synch in demos. Tries recovering OOS in old demos v27/28/29/116/117/118. New: v30/v119. CTW - MODIFICATION On my XP machine, demo playback causes the game to crash shortly in. Only bug found so far, not sure if it's OS dependent or compiler or what. Seems to happen when player input starts being simulated, but just guessing. This change effectively disables it. The related code is still enabled. (This is working on Linux, so I flipped it back to '1'. --ryan.) CTW END - MODIFICATION extern int32_t syncs[];
        if(numplayers > 1)
                return 1;
        Goin upAZfallingSmooth on the ground ((fz-(i<<8))-myz)>>1; 412;Smooth on the waterp->ang += syncangvel * constantENGINE calculates angvel for you FIX_00058: Save/load game crash in both single and multiplayer            waitforeverybody();ST 13ST 2ST 5 (must be last)ST 9ST 10ST 12ST 4ST 1ST 3ST 6ST 11    short tinc;tinc = 0; boss Breathetinc = 0;tinc = 0;
===================
=
= GetTime
=
===================

===================
=
= CenterCenter
=
===================

===================
=
= UpperLeft
=
===================

===================
=
= LowerRight
=
===================

===================
=
= CenterThrottle
=
===================

===================
=
= CenterRudder
=
===================
 FIX_00006: better naming system for screenshots + message when pic is taken.            Use ./screenshots folder. Screenshot code rerwritten. Faster and            makes smaller files. Doesn't freeze or lag the game anymore. xduke: Build a nice name w/ date and players name if in multi mode. if more than 1 player, we add name. Then add score if DM if DM or DM No spawn. Add Score as well remove last vs If this is a TC save it to the TC's directory otherwise let's save it to the root. Rare Multiplayer, when dead, total screen screwup back again! E3l1 (Coop /w monsters) sprite list corrupt 50% Univbe exit, instead, default to screen buffer. Check all caches bounds and memory usages Fix enlarger weapon selections to perfection Need sounds.c Spawning a couple of sounds at the same time Check Weapon Switching FIRE and FIRE2 Where should I flash the screen white??? Jittery on subs in mp? Check accurate memory amounts! Why squish sound at hit space when dead? Falling Counter Not reset in mp Wierd small freezer Double freeze on player?, still firing Do Mouse Flip option Save mouse aiming Laser bounce off mirrors GEORGE:   Ten in text screen. Alien: Freeze: change Press space holding player Press space tank broke 2d mode fucked in fake mp mode 207 Mail not rolling up on conveyers Fix all alien animations Do episode names in .CONS do syntak check for "{?????" Make commline parms set approiate multiplayer flags Check all breakables to see if they are exploding properly Fix freezing palette on Alien Do a demo make run overnite Fix Super Duck Slime Guies, use quickkick. Make Lasers from trip bombs reflect off mirrors Remember for lockout of sound swears Pass sender in packed, NOT Fatal sync give no message for TEN Hitting TEN BUTTON(OPTION) no TEN SCreen Check multioperateswitches for se 31,32 Fix pal for ceilings (SE#18) case 31: sprites up one high E1l1 No Kill All troops in room, sleep time Fifo for message list Bloodsplat on conveyers Meclanical Increase sound Mouse Delay at death Wierd slowdown Footprints on stuff floating Ken, The inside function is called a lot in -1 sectors No loading Univbe message rewrite Expander must cycle with rest of weapons Duck SHOOT PIPEBOMB, red wall Get commit source from mark
  1. fix pipebomb bug
  2. check george maps
  4. Save/Restore check (MP and SP)
  5. Check TEN
  6. Get Commit fixed
  8. Is mail slow?
  9. Cacheing
  10. Blue out "PLAY ON TEN" in MULTIPLAYER
  11. Eight Player test
  12. Postal.voc not found.
  13. All Monsters explode in arcade,
  check SEENINE STRENGTH,
  Change 28<<8 back to 16<<8 in hitradius
  Compare 1.3d to 1.4
  14. Check sounds/gfx for for parr lock
  15. Player # Loaded a game
  16. Replace Crane code 1.3d to 1.4
  17. Fix Greenslime
  18. Small Freeze sprite,below floor
  19. Vesa message auto abort in mp?
  20. Fucked Palette in my skip ahead in MP
  21. Load in main menu
  22. Rotated frag screen no game screen
  23. Jibs sounds when killed other dukes
  24. Ten code and /f4 mode
  25. Fix All MP Glitches!!
  26. Unrem Menues anim tenbn
  27. buy groc,clothes,scanner
  28. Why Double Defs in global and game, is so at work
  29. Check that all .objs are erased
  30. Check why 1.3ds gotweapon gamedef coop code no workie
  31. Heavy mods to net code
  32. Make sure all commline stuff works,
  33. killed all waitfor???
  34. 90k stack
  35. double door probs
  36: copy protection
  * when you start a game the duke saying that is played when you choose a skill the sound is cut off.
  * NEWBEASTJUMPING is not deleted at premap in multi-play
  if(*c == '4') no work need objs ask ken, commit
  {
  movesperpacket = 4;
  setpackettimeout(0x3fffffff,0x3fffffff);
  }
  remember, netcode load
  Ai Problem in god mode. Checkplayerhurtwall for forcefields bigforce Nuddie, posters. IMF Release commit.c to public? Document Save bug with mp Check moves per packet /f4 waitforeverybody over net? Kill IDF OBJ No shotguns under water @ tanker Unrem copyprotect Look for printf and puts Check con rewrites erase mmulti.c, or get newest objs Why nomonsters screwy in load menu in mp load last > 'y' == NOT Check xptr oos when dead rising to surface.    diaginal warping with shotguns Test white room.  Lasertripbomb arming crash The Bog Run Duke Out of windows Put Version number in con files Test diff. version playing together Reorganize dukecd Put out patch w/ two weeks testing Print draw3d Double Klick
  Duke Nukem V

  Layout:

  Settings:
  Suburbs
  Duke inflitrating neighborhoods inf. by aliens
  Death Valley:
  Sorta like a western.  Bull-skulls half buried in the sand
  Military compound:  Aliens take over nuke-missle silo, duke
  must destroy.
  Abondend Aircraft field
  Vegas:
  Blast anything bright!  Alien lights camoflauged.
  Alien Drug factory. The Blue Liquid
  Mountainal Cave:
  Interior cave battles.
  Jungle:
  Trees, canopee, animals, a mysterious hole in the earth with
  gas seaping thru.
  Penetencury:
  Good use of spotlights:
  Mental ward:
  People whom have claimed to be slowly changing into an
  alien species

  Inventory:
  Wood,
  Metal,
  Torch,
  Rope,
  Plastique,
  Cloth,
  Wiring,
  Glue,
  Cigars,
  Food,
  Duck Tape,
  Nails,
  Piping,
  Petrol,
  Uranium,
  Gold,
  Prism,
  Power Cell,

  Hand spikes (Limited usage, they become dull)
  Oxygent     (Oxygen mixed with stimulant)


  Player Skills:
  R-Left,R-Right,Foward,Back
  Strafe, Jump, Double Flip Jump for distance
  Help, Escape
  Fire/Use
  Use Menu

  After a brief resbit, Duke decides to get back to work.

  Cmdr:   "Duke, we've got a lot of scared people down there.
  Some reports even claim that people are already
  slowly changing into aliens."
  Duke:   "No problem, my speciality is in croud control."
  Cmdr:   "Croud control, my ass!  Remember that incident
  during the war?  You created nuthin' but death and
  destruction."
  Duke:   "Not destruction, justice."
  Cmdr:   "I'll take no responsibility for your actions.  Your on
  your own!  Behave your self, damnit!  You got that,
  soldger?"
  Duke:   "I've always been on my own...   Face it, it's ass kickin' time,
  SIR!"
  Cmdr:   "Get outta here...!"
  (Duke gives the Cmdr a hard stair, then cocks his weapon and
  walks out of the room)
  Cmdr:   In a wisper: "Good luck, my friend."

  (Cut to a scene where aliens are injecting genetic material
  into an unconcious subject)

  Programming:   ( the functions I need )
  Images: Polys
  Actors:
  Multi-Object sections for change (head,arms,legs,torsoe,all change)
  Facial expressions.  Pal lookup per poly?

  struct imagetype
  {
  int *itable; // AngX,AngY,AngZ,Xoff,Yoff,Zoff;
  int *idata;
  struct imagetype *prev, *next;
  }

 Test frag screen name fuckup Test all xptrs Make Jibs stick to ceiling Save Game menu crash Cache len sum err Loading in main (MP), reset totalclock? White Room Sound hitch with repeat bits Rewrite saved menues so no crash Put a getpackets after loadplayer in menus Put "loading..." before waitfor in loadpla No ready2send = 0 for loading Test Joystick Ten Bog Test Blimp respawn move 1 in player???