
 *  MikroTik SPI-NOR RouterBOARDs support
 *
 *  - MikroTik RouterBOARD mAP 2nD
 *  - MikroTik RouterBOARD mAP L-2nD
 *  - MikroTik RouterBOARD 911-2Hn (911 Lite2)
 *  - MikroTik RouterBOARD 911-5Hn (911 Lite5)
 *  - MikroTik RouterBOARD 931-2nD (hAP mini)
 *  - MikroTik RouterBOARD 941L-2nD
 *  - MikroTik RouterBOARD 951Ui-2nD
 *  - MikroTik RouterBOARD 952Ui-5ac2nD
 *  - MikroTik RouterBOARD 962UiGS-5HacT2HnT
 *  - MikroTik RouterBOARD 750UP r2
 *  - MikroTik RouterBOARD 750P-PBr2
 *  - MikroTik RouterBOARD 750 r2
 *  - MikroTik RouterBOARD LHG 5nD
 *  - MikroTik RouterBOARD wAP2nD
 *  - MikroTik RouterBOARD wAP G-5HacT2HnDwAP (wAP AC)
 *  - MikroTik RouterBOARD wAP R-2nD
 *
 *  Preliminary support for the following hardware
 *  - MikroTik RouterBOARD cAP2nD
 *  Furthermore, the cAP lite (cAPL2nD) appears to feature the exact same
 *  hardware as the mAP L-2nD. It is unknown if they share the same board
 *  identifier.
 *
 *  Copyright (C) 2017-2018 Thibaut VARENE <varenet@parisc-linux.org>
 *  Copyright (C) 2016 David Hutchison <dhutchison@bluemesh.net>
 *  Copyright (C) 2017 Ryan Mounce <ryan@mounce.com.au>
 *
 *  This program is free software; you can redistribute it and/or modify it
 *  under the terms of the GNU General Public License version 2 as published
 *  by the Free Software Foundation.
  msecs  has WAN port on PHY4  has an SSR on SPI bus 0  Flash partitions indexes 
 * Setup the SPI flash partition table based on initial parsing.
 * The kernel can be at any aligned position and have any size.
 
 * Several boards only have a single reset button, use a common
 * structure for that.
  filled dynamically  RB mAP L-2nD gpios  RB 941L-2nD gpios  common RB SSRs  RB 951Ui-2nD gpios  RB 962UiGS-5HacT2HnT gpios  Use SGMII interface for GMAC6 of the AR8337 switch  RB wAP-2nD gpios  RB cAP-2nD gpios  RB mAP-2nD gpios  RB LHG 5nD gpios  RB w APG-5HacT2HnD (wAP AC) gpios RB911L GPIOs  for reference, active low  RB 931-2nD gpios  RB wAP R-2nD (wAP R) gpios the spi-ath79 driver can only natively handle CS0. Other CS are bit-banged  CS0 is always -ENOENT: natively handled  CS1 can be updated by the code as necessary 
 * Global spi_board_info: devices that don't have an SSR only have the SPI NOR
 * flash on bus0 CS0, while devices that have an SSR add it on the same bus CS1
 
 * Common platform init routine for all SPI NOR devices.
  fix partitions based on flash parsing 
 * Common peripherals init routine for all SPI NOR devices.
 * Sets SPI and USB.
  only one device on bus0 
 * Common network init routine for all SPI NOR devices.
 * Sets LAN/WAN/WLAN.
  for QCA953x that will init mdio1_device/data  set switch to oper mode 1, PHY4 connected to CPU  init GMAC0 connected to PHY4 at 100M  set the SoC to SW_ONLY_MODE, which connects all PHYs
		 * to the internal switch.
		 * We hijack ath79_setup_ar934x_eth_cfg() to set the switch in
		 * the QCA953x, this works because this configuration bit is
		 * the same as the AR934x. There's no equivalent function for
		 * QCA953x for now.  init GMAC1 
 * Init the mAP lite hardware (QCA953x).
 * The mAP L-2nD (mAP lite) has a single ethernet port, connected to PHY0.
 * Trying to use GMAC0 in direct mode was unsucessful, so we're
 * using SW_ONLY_MODE, which connects PHY0 to MAC1 on the internal
 * switch, which is connected to GMAC1 on the SoC. GMAC0 is unused.
  GMAC1 is HW MAC, WLAN0 MAC is HW MAC + 1  mAP lite has a single reset button as gpio 16  clear internal multiplexing 
 * Init the hAP lite hardware (QCA953x).
 * The 941-2nD (hAP lite) has 4 ethernet ports, with port 2-4
 * being assigned to LAN on the casing, and port 1 being assigned
 * to "internet" (WAN) on the casing. Port 1 is connected to PHY3.
 * Since WAN is neither PHY0 nor PHY4, we cannot use GMAC0 with this device.
  GMAC1 is HW MAC, WLAN0 MAC is HW MAC + 4  hAP lite has a single reset button as gpio 16 
 * The hAP, hAP ac lite, hEX lite and hEX PoE lite share the same platform
 
	 * GMAC1 is HW MAC + 1, WLAN0 MAC IS HW MAC + 5 (hAP),
	 * WLAN1 MAC IS HW MAC + 6 (hAP ac lite)
	  These devices have a single reset button as gpio 16 
 * Init the hAP (ac lite) hardware (QCA953x).
 * The 951Ui-2nD (hAP) has 5 ethernet ports, with ports 2-5 being assigned
 * to LAN on the casing, and port 1 being assigned to "internet" (WAN).
 * Port 1 is connected to PHY4 (the ports are labelled in reverse physical
 * number), so the SoC can be set to connect GMAC0 to PHY4 and GMAC1 to the
 * internal switch for the LAN ports.
 * The device also has USB, PoE output and an SSR used for LED multiplexing.
 * The 952Ui-5ac2nD (hAP ac lite) is nearly identical to the hAP, it adds a
 * QCA9887 5GHz radio via PCI and moves 2.4GHz from WLAN0 to WLAN1.
  differentiate the hAP from the hAP ac lite 
 * Init the hEX (PoE) lite hardware (QCA953x).
 * The 750UP r2 (hEX PoE lite) is nearly identical to the hAP, only without
 * WLAN. The 750 r2 (hEX lite) is nearly identical to the 750UP r2, only
 * without USB and POE. The 750P Pbr2 (Powerbox) is nearly identical to hEX PoE
 * lite, only without USB. It shares the same bootloader board identifier.
  differentiate the hEX lite from the hEX PoE lite  differentiate the Powerbox from the hEX lite 
 * Init the hAP ac / 962UiGS-5HacT2HnT hardware (QCA9558).
 * The hAP ac has 5 ethernet ports provided by an AR8337 switch. Port 1 is
 * assigned to WAN, ports 2-5 are assigned to LAN. Port 0 is connected to the
 * SoC, ports 1-5 of the switch are connected to physical ports 1-5 in order.
 * The SFP cage is not assigned by default on RouterOS. Extra work is required
 * to support this interface as it is directly connected to the SoC (eth1).
 * Wireless is provided by a 2.4GHz radio on the SoC (WLAN1) and a 5GHz radio
 * attached via PCI (QCA9880). Red and green WLAN LEDs are populated however
 * they are not attached to GPIOs, extra work is required to support these.
 * PoE and USB output power control is supported.
  Do not call rbspi_network_setup as we have a discrete switch chip  WLAN1 MAC is HW MAC + 7  PoE output GPIO is inverted, set GPIOF_ACTIVE_LOW for consistency  This device has a single reset button as gpio 20 
 * Init the LHG hardware (AR9344).
 * The LHG 5nD has a single ethernet port connected to PHY0.
 * Wireless is provided via 5GHz WLAN1.
  GMAC1 is HW MAC, WLAN1 MAC is HW MAC + 1 
 * Init the wAP hardware.
 * The wAP 2nD has a single ethernet port.
  GMAC1 is HW MAC, WLAN0 MAC is HW MAC + 1  wAP has a single reset button as GPIO 16 
 * Init the cAP hardware (EXPERIMENTAL).
 * The cAP 2nD has a single ethernet port, and a global LED switch.
  GMAC1 is HW MAC, WLAN0 MAC is HW MAC + 1 
 * Init the mAP hardware.
 * The mAP 2nD has two ethernet ports, PoE output, SSR for LED
 * multiplexing and USB port.
  GMAC1 is HW MAC, WLAN0 MAC is HW MAC + 2  mAP 2nD has a single reset button as gpio 16 
 * Init the wAPGSC (RB wAPG-5HacT2HnD // wAP AC) hardware.
 * The wAPGSC has one Ethernet port via AR8033 with PoE input, dual radio (SoC
 * 2.4 GHz and external QCA9880) and a ZT2046Q temperature and voltage sensor
 * (currently not supported).
 
 * Setup the 911L hardware (AR9344).
 
		 * Old hardware revisions might be equipped with a NAND flash
		 * chip instead of the 16MiB SPI NOR device. Those boards are
		 * not supported at the moment, so throw a warning and skip
		 * the peripheral setup to avoid messing up the data in the
		 * flash chip.
		  Make the eth LED controllable by software. 
 * Init the hAP mini hardware (QCA953x).
 * The 931-2nD (hAP mini) has 3 ethernet ports, with port 2-3
 * being assigned to LAN on the casing, and port 1 being assigned
 * to "internet" (WAN) on the casing. Port 1 is connected to PHY2.
 * Since WAN is neither PHY0 nor PHY4, we cannot use GMAC0 with this device.
  GMAC1 is HW MAC, WLAN0 MAC is HW MAC + 3  hAP mini has two buttons 
 * Init the wAP R hardware.
 * The wAP R-2nD has a single ethernet port and a mini PCIe slot.
 * The OEM source shows it has usb (used over PCIe for LTE devices),
 * and the 'control' GPIO is assumed to be an output pin not tied to an LED.
  GMAC1 is HW MAC, WLAN0 MAC is HW MAC + 1 
 *  MikroTik SPI-NOR RouterBOARDs support
 *
 *  - MikroTik RouterBOARD mAP 2nD
 *  - MikroTik RouterBOARD mAP L-2nD
 *  - MikroTik RouterBOARD 911-2Hn (911 Lite2)
 *  - MikroTik RouterBOARD 911-5Hn (911 Lite5)
 *  - MikroTik RouterBOARD 931-2nD (hAP mini)
 *  - MikroTik RouterBOARD 941L-2nD
 *  - MikroTik RouterBOARD 951Ui-2nD
 *  - MikroTik RouterBOARD 952Ui-5ac2nD
 *  - MikroTik RouterBOARD 962UiGS-5HacT2HnT
 *  - MikroTik RouterBOARD 750UP r2
 *  - MikroTik RouterBOARD 750P-PBr2
 *  - MikroTik RouterBOARD 750 r2
 *  - MikroTik RouterBOARD LHG 5nD
 *  - MikroTik RouterBOARD wAP2nD
 *  - MikroTik RouterBOARD wAP G-5HacT2HnDwAP (wAP AC)
 *  - MikroTik RouterBOARD wAP R-2nD
 *
 *  Preliminary support for the following hardware
 *  - MikroTik RouterBOARD cAP2nD
 *  Furthermore, the cAP lite (cAPL2nD) appears to feature the exact same
 *  hardware as the mAP L-2nD. It is unknown if they share the same board
 *  identifier.
 *
 *  Copyright (C) 2017-2018 Thibaut VARENE <varenet@parisc-linux.org>
 *  Copyright (C) 2016 David Hutchison <dhutchison@bluemesh.net>
 *  Copyright (C) 2017 Ryan Mounce <ryan@mounce.com.au>
 *
 *  This program is free software; you can redistribute it and/or modify it
 *  under the terms of the GNU General Public License version 2 as published
 *  by the Free Software Foundation.
  msecs  has WAN port on PHY4  has an SSR on SPI bus 0  Flash partitions indexes 
 * Setup the SPI flash partition table based on initial parsing.
 * The kernel can be at any aligned position and have any size.
 
 * Several boards only have a single reset button, use a common
 * structure for that.
  filled dynamically  RB mAP L-2nD gpios  RB 941L-2nD gpios  common RB SSRs  RB 951Ui-2nD gpios  RB 962UiGS-5HacT2HnT gpios  Use SGMII interface for GMAC6 of the AR8337 switch  RB wAP-2nD gpios  RB cAP-2nD gpios  RB mAP-2nD gpios  RB LHG 5nD gpios  RB w APG-5HacT2HnD (wAP AC) gpios RB911L GPIOs  for reference, active low  RB 931-2nD gpios  RB wAP R-2nD (wAP R) gpios the spi-ath79 driver can only natively handle CS0. Other CS are bit-banged  CS0 is always -ENOENT: natively handled  CS1 can be updated by the code as necessary 
 * Global spi_board_info: devices that don't have an SSR only have the SPI NOR
 * flash on bus0 CS0, while devices that have an SSR add it on the same bus CS1
 
 * Common platform init routine for all SPI NOR devices.
  fix partitions based on flash parsing 
 * Common peripherals init routine for all SPI NOR devices.
 * Sets SPI and USB.
  only one device on bus0 
 * Common network init routine for all SPI NOR devices.
 * Sets LAN/WAN/WLAN.
  for QCA953x that will init mdio1_device/data  set switch to oper mode 1, PHY4 connected to CPU  init GMAC0 connected to PHY4 at 100M  set the SoC to SW_ONLY_MODE, which connects all PHYs
		 * to the internal switch.
		 * We hijack ath79_setup_ar934x_eth_cfg() to set the switch in
		 * the QCA953x, this works because this configuration bit is
		 * the same as the AR934x. There's no equivalent function for
		 * QCA953x for now.  init GMAC1 
 * Init the mAP lite hardware (QCA953x).
 * The mAP L-2nD (mAP lite) has a single ethernet port, connected to PHY0.
 * Trying to use GMAC0 in direct mode was unsucessful, so we're
 * using SW_ONLY_MODE, which connects PHY0 to MAC1 on the internal
 * switch, which is connected to GMAC1 on the SoC. GMAC0 is unused.
  GMAC1 is HW MAC, WLAN0 MAC is HW MAC + 1  mAP lite has a single reset button as gpio 16  clear internal multiplexing 
 * Init the hAP lite hardware (QCA953x).
 * The 941-2nD (hAP lite) has 4 ethernet ports, with port 2-4
 * being assigned to LAN on the casing, and port 1 being assigned
 * to "internet" (WAN) on the casing. Port 1 is connected to PHY3.
 * Since WAN is neither PHY0 nor PHY4, we cannot use GMAC0 with this device.
  GMAC1 is HW MAC, WLAN0 MAC is HW MAC + 4  hAP lite has a single reset button as gpio 16 
 * The hAP, hAP ac lite, hEX lite and hEX PoE lite share the same platform
 
	 * GMAC1 is HW MAC + 1, WLAN0 MAC IS HW MAC + 5 (hAP),
	 * WLAN1 MAC IS HW MAC + 6 (hAP ac lite)
	  These devices have a single reset button as gpio 16 
 * Init the hAP (ac lite) hardware (QCA953x).
 * The 951Ui-2nD (hAP) has 5 ethernet ports, with ports 2-5 being assigned
 * to LAN on the casing, and port 1 being assigned to "internet" (WAN).
 * Port 1 is connected to PHY4 (the ports are labelled in reverse physical
 * number), so the SoC can be set to connect GMAC0 to PHY4 and GMAC1 to the
 * internal switch for the LAN ports.
 * The device also has USB, PoE output and an SSR used for LED multiplexing.
 * The 952Ui-5ac2nD (hAP ac lite) is nearly identical to the hAP, it adds a
 * QCA9887 5GHz radio via PCI and moves 2.4GHz from WLAN0 to WLAN1.
  differentiate the hAP from the hAP ac lite 
 * Init the hEX (PoE) lite hardware (QCA953x).
 * The 750UP r2 (hEX PoE lite) is nearly identical to the hAP, only without
 * WLAN. The 750 r2 (hEX lite) is nearly identical to the 750UP r2, only
 * without USB and POE. The 750P Pbr2 (Powerbox) is nearly identical to hEX PoE
 * lite, only without USB. It shares the same bootloader board identifier.
  differentiate the hEX lite from the hEX PoE lite  differentiate the Powerbox from the hEX lite 
 * Init the hAP ac / 962UiGS-5HacT2HnT hardware (QCA9558).
 * The hAP ac has 5 ethernet ports provided by an AR8337 switch. Port 1 is
 * assigned to WAN, ports 2-5 are assigned to LAN. Port 0 is connected to the
 * SoC, ports 1-5 of the switch are connected to physical ports 1-5 in order.
 * The SFP cage is not assigned by default on RouterOS. Extra work is required
 * to support this interface as it is directly connected to the SoC (eth1).
 * Wireless is provided by a 2.4GHz radio on the SoC (WLAN1) and a 5GHz radio
 * attached via PCI (QCA9880). Red and green WLAN LEDs are populated however
 * they are not attached to GPIOs, extra work is required to support these.
 * PoE and USB output power control is supported.
  Do not call rbspi_network_setup as we have a discrete switch chip  WLAN1 MAC is HW MAC + 7  PoE output GPIO is inverted, set GPIOF_ACTIVE_LOW for consistency  This device has a single reset button as gpio 20 
 * Init the LHG hardware (AR9344).
 * The LHG 5nD has a single ethernet port connected to PHY0.
 * Wireless is provided via 5GHz WLAN1.
  GMAC1 is HW MAC, WLAN1 MAC is HW MAC + 1 
 * Init the wAP hardware.
 * The wAP 2nD has a single ethernet port.
  GMAC1 is HW MAC, WLAN0 MAC is HW MAC + 1  wAP has a single reset button as GPIO 16 
 * Init the cAP hardware (EXPERIMENTAL).
 * The cAP 2nD has a single ethernet port, and a global LED switch.
  GMAC1 is HW MAC, WLAN0 MAC is HW MAC + 1 
 * Init the mAP hardware.
 * The mAP 2nD has two ethernet ports, PoE output, SSR for LED
 * multiplexing and USB port.
  GMAC1 is HW MAC, WLAN0 MAC is HW MAC + 2  mAP 2nD has a single reset button as gpio 16 
 * Init the wAPGSC (RB wAPG-5HacT2HnD // wAP AC) hardware.
 * The wAPGSC has one Ethernet port via AR8033 with PoE input, dual radio (SoC
 * 2.4 GHz and external QCA9880) and a ZT2046Q temperature and voltage sensor
 * (currently not supported).
 
 * Setup the 911L hardware (AR9344).
 
		 * Old hardware revisions might be equipped with a NAND flash
		 * chip instead of the 16MiB SPI NOR device. Those boards are
		 * not supported at the moment, so throw a warning and skip
		 * the peripheral setup to avoid messing up the data in the
		 * flash chip.
		  Make the eth LED controllable by software. 
 * Init the hAP mini hardware (QCA953x).
 * The 931-2nD (hAP mini) has 3 ethernet ports, with port 2-3
 * being assigned to LAN on the casing, and port 1 being assigned
 * to "internet" (WAN) on the casing. Port 1 is connected to PHY2.
 * Since WAN is neither PHY0 nor PHY4, we cannot use GMAC0 with this device.
  GMAC1 is HW MAC, WLAN0 MAC is HW MAC + 3  hAP mini has two buttons 
 * Init the wAP R hardware.
 * The wAP R-2nD has a single ethernet port and a mini PCIe slot.
 * The OEM source shows it has usb (used over PCIe for LTE devices),
 * and the 'control' GPIO is assumed to be an output pin not tied to an LED.
  GMAC1 is HW MAC, WLAN0 MAC is HW MAC + 1 
 *  MikroTik SPI-NOR RouterBOARDs support
 *
 *  - MikroTik RouterBOARD mAP 2nD
 *  - MikroTik RouterBOARD mAP L-2nD
 *  - MikroTik RouterBOARD 911-2Hn (911 Lite2)
 *  - MikroTik RouterBOARD 911-5Hn (911 Lite5)
 *  - MikroTik RouterBOARD 931-2nD (hAP mini)
 *  - MikroTik RouterBOARD 941L-2nD
 *  - MikroTik RouterBOARD 951Ui-2nD
 *  - MikroTik RouterBOARD 952Ui-5ac2nD
 *  - MikroTik RouterBOARD 962UiGS-5HacT2HnT
 *  - MikroTik RouterBOARD 750UP r2
 *  - MikroTik RouterBOARD 750P-PBr2
 *  - MikroTik RouterBOARD 750 r2
 *  - MikroTik RouterBOARD LHG 5nD
 *  - MikroTik RouterBOARD wAP2nD
 *  - MikroTik RouterBOARD wAP G-5HacT2HnDwAP (wAP AC)
 *  - MikroTik RouterBOARD wAP R-2nD
 *
 *  Preliminary support for the following hardware
 *  - MikroTik RouterBOARD cAP2nD
 *  Furthermore, the cAP lite (cAPL2nD) appears to feature the exact same
 *  hardware as the mAP L-2nD. It is unknown if they share the same board
 *  identifier.
 *
 *  Copyright (C) 2017-2018 Thibaut VARENE <varenet@parisc-linux.org>
 *  Copyright (C) 2016 David Hutchison <dhutchison@bluemesh.net>
 *  Copyright (C) 2017 Ryan Mounce <ryan@mounce.com.au>
 *
 *  This program is free software; you can redistribute it and/or modify it
 *  under the terms of the GNU General Public License version 2 as published
 *  by the Free Software Foundation.
  msecs  has WAN port on PHY4  has an SSR on SPI bus 0  Flash partitions indexes 
 * Setup the SPI flash partition table based on initial parsing.
 * The kernel can be at any aligned position and have any size.
 
 * Several boards only have a single reset button, use a common
 * structure for that.
  filled dynamically  RB mAP L-2nD gpios  RB 941L-2nD gpios  common RB SSRs  RB 951Ui-2nD gpios  RB 962UiGS-5HacT2HnT gpios  Use SGMII interface for GMAC6 of the AR8337 switch  RB wAP-2nD gpios  RB cAP-2nD gpios  RB mAP-2nD gpios  RB LHG 5nD gpios  RB w APG-5HacT2HnD (wAP AC) gpios RB911L GPIOs  for reference, active low  RB 931-2nD gpios  RB wAP R-2nD (wAP R) gpios the spi-ath79 driver can only natively handle CS0. Other CS are bit-banged  CS0 is always -ENOENT: natively handled  CS1 can be updated by the code as necessary 
 * Global spi_board_info: devices that don't have an SSR only have the SPI NOR
 * flash on bus0 CS0, while devices that have an SSR add it on the same bus CS1
 
 * Common platform init routine for all SPI NOR devices.
  fix partitions based on flash parsing 
 * Common peripherals init routine for all SPI NOR devices.
 * Sets SPI and USB.
  only one device on bus0 
 * Common network init routine for all SPI NOR devices.
 * Sets LAN/WAN/WLAN.
  for QCA953x that will init mdio1_device/data  set switch to oper mode 1, PHY4 connected to CPU  init GMAC0 connected to PHY4 at 100M  set the SoC to SW_ONLY_MODE, which connects all PHYs
		 * to the internal switch.
		 * We hijack ath79_setup_ar934x_eth_cfg() to set the switch in
		 * the QCA953x, this works because this configuration bit is
		 * the same as the AR934x. There's no equivalent function for
		 * QCA953x for now.  init GMAC1 
 * Init the mAP lite hardware (QCA953x).
 * The mAP L-2nD (mAP lite) has a single ethernet port, connected to PHY0.
 * Trying to use GMAC0 in direct mode was unsucessful, so we're
 * using SW_ONLY_MODE, which connects PHY0 to MAC1 on the internal
 * switch, which is connected to GMAC1 on the SoC. GMAC0 is unused.
  GMAC1 is HW MAC, WLAN0 MAC is HW MAC + 1  mAP lite has a single reset button as gpio 16  clear internal multiplexing 
 * Init the hAP lite hardware (QCA953x).
 * The 941-2nD (hAP lite) has 4 ethernet ports, with port 2-4
 * being assigned to LAN on the casing, and port 1 being assigned
 * to "internet" (WAN) on the casing. Port 1 is connected to PHY3.
 * Since WAN is neither PHY0 nor PHY4, we cannot use GMAC0 with this device.
  GMAC1 is HW MAC, WLAN0 MAC is HW MAC + 4  hAP lite has a single reset button as gpio 16 
 * The hAP, hAP ac lite, hEX lite and hEX PoE lite share the same platform
 
	 * GMAC1 is HW MAC + 1, WLAN0 MAC IS HW MAC + 5 (hAP),
	 * WLAN1 MAC IS HW MAC + 6 (hAP ac lite)
	  These devices have a single reset button as gpio 16 
 * Init the hAP (ac lite) hardware (QCA953x).
 * The 951Ui-2nD (hAP) has 5 ethernet ports, with ports 2-5 being assigned
 * to LAN on the casing, and port 1 being assigned to "internet" (WAN).
 * Port 1 is connected to PHY4 (the ports are labelled in reverse physical
 * number), so the SoC can be set to connect GMAC0 to PHY4 and GMAC1 to the
 * internal switch for the LAN ports.
 * The device also has USB, PoE output and an SSR used for LED multiplexing.
 * The 952Ui-5ac2nD (hAP ac lite) is nearly identical to the hAP, it adds a
 * QCA9887 5GHz radio via PCI and moves 2.4GHz from WLAN0 to WLAN1.
  differentiate the hAP from the hAP ac lite 
 * Init the hEX (PoE) lite hardware (QCA953x).
 * The 750UP r2 (hEX PoE lite) is nearly identical to the hAP, only without
 * WLAN. The 750 r2 (hEX lite) is nearly identical to the 750UP r2, only
 * without USB and POE. The 750P Pbr2 (Powerbox) is nearly identical to hEX PoE
 * lite, only without USB. It shares the same bootloader board identifier.
  differentiate the hEX lite from the hEX PoE lite  differentiate the Powerbox from the hEX lite 
 * Init the hAP ac / 962UiGS-5HacT2HnT hardware (QCA9558).
 * The hAP ac has 5 ethernet ports provided by an AR8337 switch. Port 1 is
 * assigned to WAN, ports 2-5 are assigned to LAN. Port 0 is connected to the
 * SoC, ports 1-5 of the switch are connected to physical ports 1-5 in order.
 * The SFP cage is not assigned by default on RouterOS. Extra work is required
 * to support this interface as it is directly connected to the SoC (eth1).
 * Wireless is provided by a 2.4GHz radio on the SoC (WLAN1) and a 5GHz radio
 * attached via PCI (QCA9880). Red and green WLAN LEDs are populated however
 * they are not attached to GPIOs, extra work is required to support these.
 * PoE and USB output power control is supported.
  Do not call rbspi_network_setup as we have a discrete switch chip  WLAN1 MAC is HW MAC + 7  PoE output GPIO is inverted, set GPIOF_ACTIVE_LOW for consistency  This device has a single reset button as gpio 20 
 * Init the LHG hardware (AR9344).
 * The LHG 5nD has a single ethernet port connected to PHY0.
 * Wireless is provided via 5GHz WLAN1.
  GMAC1 is HW MAC, WLAN1 MAC is HW MAC + 1 
 * Init the wAP hardware.
 * The wAP 2nD has a single ethernet port.
  GMAC1 is HW MAC, WLAN0 MAC is HW MAC + 1  wAP has a single reset button as GPIO 16 
 * Init the cAP hardware (EXPERIMENTAL).
 * The cAP 2nD has a single ethernet port, and a global LED switch.
  GMAC1 is HW MAC, WLAN0 MAC is HW MAC + 1 
 * Init the mAP hardware.
 * The mAP 2nD has two ethernet ports, PoE output, SSR for LED
 * multiplexing and USB port.
  GMAC1 is HW MAC, WLAN0 MAC is HW MAC + 2  mAP 2nD has a single reset button as gpio 16 
 * Init the wAPGSC (RB wAPG-5HacT2HnD // wAP AC) hardware.
 * The wAPGSC has one Ethernet port via AR8033 with PoE input, dual radio (SoC
 * 2.4 GHz and external QCA9880) and a ZT2046Q temperature and voltage sensor
 * (currently not supported).
 
 * Setup the 911L hardware (AR9344).
 
		 * Old hardware revisions might be equipped with a NAND flash
		 * chip instead of the 16MiB SPI NOR device. Those boards are
		 * not supported at the moment, so throw a warning and skip
		 * the peripheral setup to avoid messing up the data in the
		 * flash chip.
		  Make the eth LED controllable by software. 
 * Init the hAP mini hardware (QCA953x).
 * The 931-2nD (hAP mini) has 3 ethernet ports, with port 2-3
 * being assigned to LAN on the casing, and port 1 being assigned
 * to "internet" (WAN) on the casing. Port 1 is connected to PHY2.
 * Since WAN is neither PHY0 nor PHY4, we cannot use GMAC0 with this device.
  GMAC1 is HW MAC, WLAN0 MAC is HW MAC + 3  hAP mini has two buttons 
 * Init the wAP R hardware.
 * The wAP R-2nD has a single ethernet port and a mini PCIe slot.
 * The OEM source shows it has usb (used over PCIe for LTE devices),
 * and the 'control' GPIO is assumed to be an output pin not tied to an LED.
  GMAC1 is HW MAC, WLAN0 MAC is HW MAC + 1 
 *  MikroTik SPI-NOR RouterBOARDs support
 *
 *  - MikroTik RouterBOARD mAP 2nD
 *  - MikroTik RouterBOARD mAP L-2nD
 *  - MikroTik RouterBOARD 911-2Hn (911 Lite2)
 *  - MikroTik RouterBOARD 911-5Hn (911 Lite5)
 *  - MikroTik RouterBOARD 931-2nD (hAP mini)
 *  - MikroTik RouterBOARD 941L-2nD
 *  - MikroTik RouterBOARD 951Ui-2nD
 *  - MikroTik RouterBOARD 952Ui-5ac2nD
 *  - MikroTik RouterBOARD 962UiGS-5HacT2HnT
 *  - MikroTik RouterBOARD 750UP r2
 *  - MikroTik RouterBOARD 750P-PBr2
 *  - MikroTik RouterBOARD 750 r2
 *  - MikroTik RouterBOARD LHG 5nD
 *  - MikroTik RouterBOARD wAP2nD
 *  - MikroTik RouterBOARD wAP G-5HacT2HnDwAP (wAP AC)
 *  - MikroTik RouterBOARD wAP R-2nD
 *
 *  Preliminary support for the following hardware
 *  - MikroTik RouterBOARD cAP2nD
 *  Furthermore, the cAP lite (cAPL2nD) appears to feature the exact same
 *  hardware as the mAP L-2nD. It is unknown if they share the same board
 *  identifier.
 *
 *  Copyright (C) 2017-2018 Thibaut VARENE <varenet@parisc-linux.org>
 *  Copyright (C) 2016 David Hutchison <dhutchison@bluemesh.net>
 *  Copyright (C) 2017 Ryan Mounce <ryan@mounce.com.au>
 *
 *  This program is free software; you can redistribute it and/or modify it
 *  under the terms of the GNU General Public License version 2 as published
 *  by the Free Software Foundation.
  msecs  has WAN port on PHY4  has an SSR on SPI bus 0  Flash partitions indexes 
 * Setup the SPI flash partition table based on initial parsing.
 * The kernel can be at any aligned position and have any size.
 
 * Several boards only have a single reset button, use a common
 * structure for that.
  filled dynamically  RB mAP L-2nD gpios  RB 941L-2nD gpios  common RB SSRs  RB 951Ui-2nD gpios  RB 962UiGS-5HacT2HnT gpios  Use SGMII interface for GMAC6 of the AR8337 switch  RB wAP-2nD gpios  RB cAP-2nD gpios  RB mAP-2nD gpios  RB LHG 5nD gpios  RB w APG-5HacT2HnD (wAP AC) gpios RB911L GPIOs  for reference, active low  RB 931-2nD gpios  RB wAP R-2nD (wAP R) gpios the spi-ath79 driver can only natively handle CS0. Other CS are bit-banged  CS0 is always -ENOENT: natively handled  CS1 can be updated by the code as necessary 
 * Global spi_board_info: devices that don't have an SSR only have the SPI NOR
 * flash on bus0 CS0, while devices that have an SSR add it on the same bus CS1
 
 * Common platform init routine for all SPI NOR devices.
  fix partitions based on flash parsing 
 * Common peripherals init routine for all SPI NOR devices.
 * Sets SPI and USB.
  only one device on bus0 
 * Common network init routine for all SPI NOR devices.
 * Sets LAN/WAN/WLAN.
  for QCA953x that will init mdio1_device/data  set switch to oper mode 1, PHY4 connected to CPU  init GMAC0 connected to PHY4 at 100M  set the SoC to SW_ONLY_MODE, which connects all PHYs
		 * to the internal switch.
		 * We hijack ath79_setup_ar934x_eth_cfg() to set the switch in
		 * the QCA953x, this works because this configuration bit is
		 * the same as the AR934x. There's no equivalent function for
		 * QCA953x for now.  init GMAC1 
 * Init the mAP lite hardware (QCA953x).
 * The mAP L-2nD (mAP lite) has a single ethernet port, connected to PHY0.
 * Trying to use GMAC0 in direct mode was unsucessful, so we're
 * using SW_ONLY_MODE, which connects PHY0 to MAC1 on the internal
 * switch, which is connected to GMAC1 on the SoC. GMAC0 is unused.
  GMAC1 is HW MAC, WLAN0 MAC is HW MAC + 1  mAP lite has a single reset button as gpio 16  clear internal multiplexing 
 * Init the hAP lite hardware (QCA953x).
 * The 941-2nD (hAP lite) has 4 ethernet ports, with port 2-4
 * being assigned to LAN on the casing, and port 1 being assigned
 * to "internet" (WAN) on the casing. Port 1 is connected to PHY3.
 * Since WAN is neither PHY0 nor PHY4, we cannot use GMAC0 with this device.
  GMAC1 is HW MAC, WLAN0 MAC is HW MAC + 4  hAP lite has a single reset button as gpio 16 
 * The hAP, hAP ac lite, hEX lite and hEX PoE lite share the same platform
 
	 * GMAC1 is HW MAC + 1, WLAN0 MAC IS HW MAC + 5 (hAP),
	 * WLAN1 MAC IS HW MAC + 6 (hAP ac lite)
	  These devices have a single reset button as gpio 16 
 * Init the hAP (ac lite) hardware (QCA953x).
 * The 951Ui-2nD (hAP) has 5 ethernet ports, with ports 2-5 being assigned
 * to LAN on the casing, and port 1 being assigned to "internet" (WAN).
 * Port 1 is connected to PHY4 (the ports are labelled in reverse physical
 * number), so the SoC can be set to connect GMAC0 to PHY4 and GMAC1 to the
 * internal switch for the LAN ports.
 * The device also has USB, PoE output and an SSR used for LED multiplexing.
 * The 952Ui-5ac2nD (hAP ac lite) is nearly identical to the hAP, it adds a
 * QCA9887 5GHz radio via PCI and moves 2.4GHz from WLAN0 to WLAN1.
  differentiate the hAP from the hAP ac lite 
 * Init the hEX (PoE) lite hardware (QCA953x).
 * The 750UP r2 (hEX PoE lite) is nearly identical to the hAP, only without
 * WLAN. The 750 r2 (hEX lite) is nearly identical to the 750UP r2, only
 * without USB and POE. The 750P Pbr2 (Powerbox) is nearly identical to hEX PoE
 * lite, only without USB. It shares the same bootloader board identifier.
  differentiate the hEX lite from the hEX PoE lite  differentiate the Powerbox from the hEX lite 
 * Init the hAP ac / 962UiGS-5HacT2HnT hardware (QCA9558).
 * The hAP ac has 5 ethernet ports provided by an AR8337 switch. Port 1 is
 * assigned to WAN, ports 2-5 are assigned to LAN. Port 0 is connected to the
 * SoC, ports 1-5 of the switch are connected to physical ports 1-5 in order.
 * The SFP cage is not assigned by default on RouterOS. Extra work is required
 * to support this interface as it is directly connected to the SoC (eth1).
 * Wireless is provided by a 2.4GHz radio on the SoC (WLAN1) and a 5GHz radio
 * attached via PCI (QCA9880). Red and green WLAN LEDs are populated however
 * they are not attached to GPIOs, extra work is required to support these.
 * PoE and USB output power control is supported.
  Do not call rbspi_network_setup as we have a discrete switch chip  WLAN1 MAC is HW MAC + 7  PoE output GPIO is inverted, set GPIOF_ACTIVE_LOW for consistency  This device has a single reset button as gpio 20 
 * Init the LHG hardware (AR9344).
 * The LHG 5nD has a single ethernet port connected to PHY0.
 * Wireless is provided via 5GHz WLAN1.
  GMAC1 is HW MAC, WLAN1 MAC is HW MAC + 1 
 * Init the wAP hardware.
 * The wAP 2nD has a single ethernet port.
  GMAC1 is HW MAC, WLAN0 MAC is HW MAC + 1  wAP has a single reset button as GPIO 16 
 * Init the cAP hardware (EXPERIMENTAL).
 * The cAP 2nD has a single ethernet port, and a global LED switch.
  GMAC1 is HW MAC, WLAN0 MAC is HW MAC + 1 
 * Init the mAP hardware.
 * The mAP 2nD has two ethernet ports, PoE output, SSR for LED
 * multiplexing and USB port.
  GMAC1 is HW MAC, WLAN0 MAC is HW MAC + 2  mAP 2nD has a single reset button as gpio 16 
 * Init the wAPGSC (RB wAPG-5HacT2HnD // wAP AC) hardware.
 * The wAPGSC has one Ethernet port via AR8033 with PoE input, dual radio (SoC
 * 2.4 GHz and external QCA9880) and a ZT2046Q temperature and voltage sensor
 * (currently not supported).
 
 * Setup the 911L hardware (AR9344).
 
		 * Old hardware revisions might be equipped with a NAND flash
		 * chip instead of the 16MiB SPI NOR device. Those boards are
		 * not supported at the moment, so throw a warning and skip
		 * the peripheral setup to avoid messing up the data in the
		 * flash chip.
		  Make the eth LED controllable by software. 
 * Init the hAP mini hardware (QCA953x).
 * The 931-2nD (hAP mini) has 3 ethernet ports, with port 2-3
 * being assigned to LAN on the casing, and port 1 being assigned
 * to "internet" (WAN) on the casing. Port 1 is connected to PHY2.
 * Since WAN is neither PHY0 nor PHY4, we cannot use GMAC0 with this device.
  GMAC1 is HW MAC, WLAN0 MAC is HW MAC + 3  hAP mini has two buttons 
 * Init the wAP R hardware.
 * The wAP R-2nD has a single ethernet port and a mini PCIe slot.
 * The OEM source shows it has usb (used over PCIe for LTE devices),
 * and the 'control' GPIO is assumed to be an output pin not tied to an LED.
  GMAC1 is HW MAC, WLAN0 MAC is HW MAC + 1 