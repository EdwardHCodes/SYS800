
 * Builder/viewer/extractor utility for Poray firmware image files
 *
 * Copyright (C) 2013 Michel Stempin <michel.stempin@wanadoo.fr>
 * Copyright (C) 2013 Felix Kaechele <felix@fetzig.org>
 * Copyright (C) 2013 <admin@openschemes.com>
 *
 * This tool is based on:
 *   TP-Link firmware upgrade tool.
 *   Copyright (C) 2009 Gabor Juhos <juhosg@openwrt.org>
 *
 * Itself based on:
 *   TP-Link WR941 V2 firmware checksum fixing tool.
 *   Copyright (C) 2008,2009 Wang Jian <lark@linux.net.cn>
 *
 * This program is free software; you can redistribute it and/or modify it
 * under the terms of the GNU General Public License version 2 as published
 * by the Free Software Foundation.
 *
  Fixed header flags  Recognized Hardware ID magic  Recognized XOR obfuscation keys  XOR key length  Name of the file  Length of the file  Hardware id  Firmware data length  Header flags 
 * Globals
  terminating entry  terminating entry 
 * Message macros
 
 * Find a board by its name
 
 * Find a board by its hardware ID
 
 * Find a Flash memory layout by its name
 
 * Display usage
 
 * Get file statistics
 
 * Read file into buffer
 
 * Check command line options
 
 * Fill in firmware header
 
 * Compute firmware checksum
 
 * (De)obfuscate firmware using an XOR operation with a fixed length key
 
 * Write firmware to file
 
 * Build firmware file
  Fill in header  Compute firmware checksum  Cannot use network order function because checksum is not word-aligned  XOR obfuscate firmware  Write firmware file  Helper functions to inspect_fw() representing different output formats  XOR unobfuscate firmware  Compute firmware checksum  Cannot use network order function because checksum is not word-aligned  Verify checksum 
 * Main entry point
 
 * Builder/viewer/extractor utility for Poray firmware image files
 *
 * Copyright (C) 2013 Michel Stempin <michel.stempin@wanadoo.fr>
 * Copyright (C) 2013 Felix Kaechele <felix@fetzig.org>
 * Copyright (C) 2013 <admin@openschemes.com>
 *
 * This tool is based on:
 *   TP-Link firmware upgrade tool.
 *   Copyright (C) 2009 Gabor Juhos <juhosg@openwrt.org>
 *
 * Itself based on:
 *   TP-Link WR941 V2 firmware checksum fixing tool.
 *   Copyright (C) 2008,2009 Wang Jian <lark@linux.net.cn>
 *
 * This program is free software; you can redistribute it and/or modify it
 * under the terms of the GNU General Public License version 2 as published
 * by the Free Software Foundation.
 *
  Fixed header flags  Recognized Hardware ID magic  Recognized XOR obfuscation keys  XOR key length  Name of the file  Length of the file  Hardware id  Firmware data length  Header flags 
 * Globals
  terminating entry  terminating entry 
 * Message macros
 
 * Find a board by its name
 
 * Find a board by its hardware ID
 
 * Find a Flash memory layout by its name
 
 * Display usage
 
 * Get file statistics
 
 * Read file into buffer
 
 * Check command line options
 
 * Fill in firmware header
 
 * Compute firmware checksum
 
 * (De)obfuscate firmware using an XOR operation with a fixed length key
 
 * Write firmware to file
 
 * Build firmware file
  Fill in header  Compute firmware checksum  Cannot use network order function because checksum is not word-aligned  XOR obfuscate firmware  Write firmware file  Helper functions to inspect_fw() representing different output formats  XOR unobfuscate firmware  Compute firmware checksum  Cannot use network order function because checksum is not word-aligned  Verify checksum 
 * Main entry point
 
 * Builder/viewer/extractor utility for Poray firmware image files
 *
 * Copyright (C) 2013 Michel Stempin <michel.stempin@wanadoo.fr>
 * Copyright (C) 2013 Felix Kaechele <felix@fetzig.org>
 * Copyright (C) 2013 <admin@openschemes.com>
 *
 * This tool is based on:
 *   TP-Link firmware upgrade tool.
 *   Copyright (C) 2009 Gabor Juhos <juhosg@openwrt.org>
 *
 * Itself based on:
 *   TP-Link WR941 V2 firmware checksum fixing tool.
 *   Copyright (C) 2008,2009 Wang Jian <lark@linux.net.cn>
 *
 * This program is free software; you can redistribute it and/or modify it
 * under the terms of the GNU General Public License version 2 as published
 * by the Free Software Foundation.
 *
  Fixed header flags  Recognized Hardware ID magic  Recognized XOR obfuscation keys  XOR key length  Name of the file  Length of the file  Hardware id  Firmware data length  Header flags 
 * Globals
  terminating entry  terminating entry 
 * Message macros
 
 * Find a board by its name
 
 * Find a board by its hardware ID
 
 * Find a Flash memory layout by its name
 
 * Display usage
 
 * Get file statistics
 
 * Read file into buffer
 
 * Check command line options
 
 * Fill in firmware header
 
 * Compute firmware checksum
 
 * (De)obfuscate firmware using an XOR operation with a fixed length key
 
 * Write firmware to file
 
 * Build firmware file
  Fill in header  Compute firmware checksum  Cannot use network order function because checksum is not word-aligned  XOR obfuscate firmware  Write firmware file  Helper functions to inspect_fw() representing different output formats  XOR unobfuscate firmware  Compute firmware checksum  Cannot use network order function because checksum is not word-aligned  Verify checksum 
 * Main entry point
 